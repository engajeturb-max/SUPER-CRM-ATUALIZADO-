import{j as e,y as qe,b8 as Pt,a5 as Ft,bl as Tt,bm as It,bn as Et,bo as zt,bp as Dt,as as ot,r as lt,a7 as v,a3 as ct,bq as Lt,br as Mt,bs as Rt,bt as $t,bu as Ot,bv as Gt,bw as Vt,bx as qt,by as Bt,bz as Ut,bA as Wt,bB as Ht,bC as Be,bD as Kt,bE as Xt,bF as Yt,bG as Ue,bH as We,bI as Jt,bJ as Qt,bK as Zt,bL as es,bM as ts,bN as ss,bO as as,bP as ns,bQ as rs,bR as Le,Q as He,P as we,bS as dt,bT as is,bU as O,bV as mt,bW as Me,bX as os,bY as Ae,bZ as oe,b_ as ls,b$ as Pe,c0 as xt,c1 as W,a8 as Ee,c2 as cs,z as ut,X as Ke,I,c3 as Xe,c4 as ds,c5 as ms,c6 as xs,c7 as us,c8 as ps,c9 as gs,ca as bs,cb as fs,cc as hs,c as vs,a2 as js,ba as ys,cd as Ns,ce as Cs,a4 as ws,a6 as _s,cf as je,cg as pt,ch as gt,ci as ve,cj as Ss,ck as Fe,cl as be,cm as ks,cn as As,b as Ps}from"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a9150010.js";import{a as N,R as K}from"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a915004.js";import{b as Ye,u as w}from"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a9150019.js";import{c as F}from"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a915007.js";import{f as ze,u as Fs}from"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a9150021.js";import{Q as me,n as D,o as E,u as Re,a as $e,m as bt,p as Ts,av as Is,aq as Te}from"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a9150023.js";import{u as h}from"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a91500108.js";import{C as _,E as Es,d as zs,u as z,a as ee,b as Ds,e as ft,g as ht}from"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a9150046.js";import{d as Ls}from"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a91500110.js";import{A as Ms}from"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a91500195.js";import{A as Rs}from"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a91500199.js";import{R as $s}from"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a9150092.js";import{W as S}from"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a9150018.js";import{E as Os,I as vt}from"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a91500200.js";import{u as Oe}from"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a915005.js";import{P as Gs}from"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a91500168.js";import{j as jt,X as yt,T as Vs,L as Je,R as qs,k as Bs,l as Qe,m as Us,n as Ws,U as Hs,o as Ks,E as Xs,p as Ze}from"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a915008.js";import{u as Ys}from"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a9150063.js";import{u as Js}from"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a9150095.js";import{a as Qs}from"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a9150093.js";import"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a91500.js";import"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a915009.js";import"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a9150047.js";import"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a915006.js";import"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a915002.js";import"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a915003.js";import"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a91500107.js";import"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a91500127.js";import"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a9150028.js";import"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a9150041.js";import"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a9150038.js";import"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a9150060.js";import"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a9150074.js";import"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a91500109.js";import"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a9150027.js";import"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a9150037.js";import"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a9150036.js";import"./v_7_4_2_7_b7b85612-c64e-4acf-adcb-deb761a91500155.js";const te=F((t,s)=>({activePage:"campaigns",setActivePage:a=>{s().activePage!==a&&t({activePage:a})}})),ye=F()(me(t=>({isHidden:!1,toggleHeader:()=>t(s=>({isHidden:!s.isHidden}))}),{name:"useHeaderController-store",version:1,partialize:t=>({isHidden:t.isHidden})})),Zs=({type:t,icon:s,label:a,title:n,onClick:r})=>{const o=te(l=>l.activePage)===t,d=h(l=>l.campaigns.find(p=>p.id===l.currentCampaignId)),x=(d==null?void 0:d.status)===_.SENDING,m={exitToPanel:"#ef4444",exitToWhats:"#22c55e"};return e.jsxs(qe.button,{type:"button",onClick:r,"aria-label":a,title:n||a,className:`w-4/5 p-2 relative rounded-md cursor-pointer place-items-center ${o?"bg-[var(--filter-btn-active-bg)] text-[var(--filter-btn-active-text)]":"bg-[var(--filter-btn-inactive-bg)] hover:bg-[var(--sidebar-line-color)] border border-[var(--filter-btn-inactive-border-color)]"}`,whileHover:{scale:1.05,boxShadow:"0px 5px 10px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},children:[e.jsx(qe.div,{whileHover:{rotate:2},transition:{type:"spring",stiffness:400,damping:20},children:e.jsx(s,{color:m[t]??void 0,className:"2xl:text-2.5xl text-lg"})}),x&&t==="sendFastCampaign"&&e.jsx("div",{className:"absolute top-0.5 right-0.5 pointer-events-none",children:e.jsx(Pt,{tipo:"ativado",size:2})})]})},De=({width:t="100%",borderColor:s="var(--sidebar-line-color)",borderWidth:a="1.5px",margin:n="0"})=>e.jsx("hr",{style:{width:t,borderColor:s,borderWidth:a,borderStyle:"solid",margin:n}}),ea=()=>{const t=Ye(m=>m.theme),{setTheme:s}=Ye.getState(),{setActivePage:a}=te.getState(),n=ye(m=>m.isHidden),r=w(m=>m.language),i=m=>{switch(m){case"sendFastCampaign":a("sendFastCampaign");break;case"campaigns":a("campaigns");break;case"toggleHiddenHeader":ye.getState().toggleHeader();break;case"themeToggle":s(!t);break;case"exitToPanel":ze.getState().open(e.jsx(Es,{}));break;case"exitToWhats":ze.getState().close();break;default:console.warn("Ação não implementada:",m)}},o=[{type:"sendFastCampaign",icon:Ft,label:r.sidebar_enviar_campanha,title:r.sidebar_enviar_campanha,onClick:()=>i("sendFastCampaign")},{type:"campaigns",icon:Tt,label:r.sidebar_gerenciar_campanhas,title:r.sidebar_gerenciar_campanhas,onClick:()=>i("campaigns")}],d=[{type:"toggleHiddenHeader",icon:n?It:Et,label:n?r.sidebar_mostrar_cabecalho:r.sidebar_ocultar_cabecalho,title:n?r.sidebar_mostrar_cabecalho:r.sidebar_ocultar_cabecalho,onClick:()=>i("toggleHiddenHeader")},{type:"themeToggle",icon:t?zt:Dt,label:r.sidebar_alternar_tema,title:r.sidebar_alternar_tema_desc,onClick:()=>i("themeToggle")},{type:"exitToWhats",icon:ot,label:r.sidebar_voltar_whats,title:r.sidebar_voltar_whats,onClick:()=>i("exitToWhats")},{type:"exitToPanel",icon:Ls,label:r.sidebar_voltar_painel,title:r.sidebar_voltar_painel,onClick:()=>i("exitToPanel")}],x=m=>m.map(l=>e.jsx(Zs,{...l},l.type));return e.jsxs("aside",{className:"bg-[var(--sidebar-bg-primary)] flex flex-col items-center justify-between w-12 2xl:w-16 py-1",children:[e.jsxs("div",{className:"w-full flex flex-col items-center gap-1",children:[e.jsx("img",{src:chrome.runtime.getURL("label/icons/icon.png"),className:"object-cover w-4/5 h-auto rounded-full",alt:"Logo"}),e.jsx(De,{}),x(o)]}),e.jsxs("div",{className:"w-full flex flex-col items-center gap-1",children:[e.jsx(De,{}),x(d)]})]})};function Nt({name:t}){return{newCampaign:{id:lt(),name:t,selectedContacts:[],actions:[],status:_.DRAFT,config:zs,createdAt:new Date,updatedAt:new Date}}}const ta=()=>{const t=w(o=>o.language),{addCampaign:s,setCurrentCampaignId:a}=h.getState(),n=h(o=>o.campaigns),r=h(o=>o.currentCampaignId),i=n.find(o=>o.id===r);return N.useEffect(()=>{if(!r||!i){const o=new Date().toLocaleString(void 0,{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),{newCampaign:d}=Nt({name:`${t.ensure_campanha} ${o}`});s(d),a(d.id)}},[r,n,s,a,i]),i};var Ct=function(t){var s=N.useRef(null),a=function(n){n.preventDefault();var r=s.current;if(r){n.clientX;var i=n.clientY;r.scrollLeft;var o=r.scrollTop,d=function(m){r.scrollTop=o-(m.clientY-i)},x=function(){document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",x),r.style.cursor="grab"};r.style.cursor="grabbing",document.addEventListener("mousemove",d),document.addEventListener("mouseup",x)}};return{ref:s,onMouseDown:a}},sa=function(t,s){var a=typeof Symbol=="function"&&t[Symbol.iterator];if(!a)return t;var n=a.call(t),r,i=[],o;try{for(;(s===void 0||s-- >0)&&!(r=n.next()).done;)i.push(r.value)}catch(d){o={error:d}}finally{try{r&&!r.done&&(a=n.return)&&a.call(n)}finally{if(o)throw o.error}}return i},se={sm:640,md:768,lg:1024,xl:1280,"2xl":1536},G=function(){var t=sa(N.useState("xs"),2),s=t[0],a=t[1];return N.useEffect(function(){var n=function(){var r=window.innerWidth;r>=se["2xl"]?a("2xl"):r>=se.xl?a("xl"):r>=se.lg?a("lg"):r>=se.md?a("md"):r>=se.sm?a("sm"):a("xs")};return n(),window.addEventListener("resize",n),function(){return window.removeEventListener("resize",n)}},[]),{breakpoint:s,isMobile:s==="xs"||s==="sm",isTablet:s==="md",isDesktop:s==="lg"||s==="xl"||s==="2xl"}},aa=function(t,s){var a=typeof Symbol=="function"&&t[Symbol.iterator];if(!a)return t;var n=a.call(t),r,i=[],o;try{for(;(s===void 0||s-- >0)&&!(r=n.next()).done;)i.push(r.value)}catch(d){o={error:d}}finally{try{r&&!r.done&&(a=n.return)&&a.call(n)}finally{if(o)throw o.error}}return i};function na(t,s){var a=aa(N.useState(!1),2),n=a[0],r=a[1];return N.useEffect(function(){var i=t.persist.onFinishHydration(function(){return setTimeout(function(){return r(!0)},s)});return setTimeout(function(){return r(t.persist.hasHydrated())},s),function(){i()}},[t,s]),n}const ra=()=>{var m;const t=z(l=>l.steps),s=z(l=>l.currentStep),a=t.findIndex(({key:l})=>l===s),n=h(l=>l.currentCampaignId),i=((m=h(l=>l.campaigns).find(l=>l.id===n))==null?void 0:m.name)||"Nome Desconhecido",{breakpoint:o}=G(),d={width:o==="2xl"?"36px":"24px",margin:o==="2xl"?"0 12px":"0 8px"},x=ye(l=>l.isHidden);return e.jsxs("header",{children:[!x&&e.jsx("div",{className:"flex items-center justify-center py-2 2xl:py-3",children:t.map(({key:l,icon:p,label:g},u)=>{const c=u<=a;return e.jsxs("div",{className:"flex items-center",children:[u!==0&&e.jsx(De,{width:d.width,margin:d.margin,borderColor:c?"var(--primaria)":"var(--sidebar-line-color)"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:v("size-7 2xl:size-9 rounded-full flex items-center justify-center",c?"bg-[var(--primaria)]":"bg-[var(--step-bg-inactive)]"),children:e.jsx(p,{className:v(c?"text-white":"text-[var(--step-icon-color)]","size-4 2xl:size-5")})}),e.jsx("span",{className:v("absolute left-1/2 -translate-x-1/2 top-full text-xs 2xl:text-sm font-semibold whitespace-nowrap",c?"text-[var(--primaria)]":"text-[var(--step-label-color)]"),children:g})]})]},l)})}),e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"divider before:bg-[var(--sidebar-line-color)] after:bg-[var(--sidebar-line-color)]",children:e.jsx("span",{className:"badge badge-soft bg-[var(--primaria)] text-white !text-xs 2xl:!text-sm font-semibold",children:i})})})]})},_e=({title:t,subtitle:s})=>e.jsxs("div",{className:"mb-2 2xl:mb-4",children:[e.jsx("h1",{className:"text-lg 2xl:text-2xl font-medium leading-none text-[var(--primary-strong)]",children:t}),s&&e.jsx("p",{className:"text-sm 2xl:text-lg text-[var(--light-text-color)]",children:s})]}),ia=()=>{const t=h(n=>n.campaigns.find(r=>r.id===n.currentCampaignId)),a=((t==null?void 0:t.actions)||[]).length===0?"col-span-2":"";return e.jsx("div",{className:v(a,"max-h-[55dvh] overflow-y-auto transition-all duration-200","bg-[var(--eem-bg-secondary)] p-2 rounded-md h-fit"),children:e.jsx(Ms,{acaoModel:"useAcaoEnvioEmMassaNew",placement:"left"})})},P=F(t=>({contacts:[],setContacts:s=>t({contacts:s}),loading:!0,setLoading:s=>t({loading:s})})),oa=()=>{const t=()=>v("text-xs 2xl:text-base font-medium w-full text-left h-7 2xl:h-10 rounded-md transition-transform duration-200 mb-1 last:mb-0","border border-solid flex items-center justify-between px-1.5 leading-tight transform-gpu will-change-transform motion-reduce:transform-none","!border-[var(--filter-btn-inactive-border-color)] !bg-[var(--filter-btn-inactive-bg)] hover:!scale-[0.98]","hover:!bg-[var(--filter-btn-inactive-bg)] active:!bg-[var(--filter-btn-inactive-bg)] active:!text-[var(--primary-strong)]"),s={containerClassName:v("!w-full !p-0.5"),itemClassName:t()};return e.jsx("div",{children:e.jsx(Rs,{acaoModel:"useAcaoEnvioEmMassaNew",style:s})})},la=()=>{const{breakpoint:t}=G(),s=t==="2xl"?"560":"418";return e.jsx("div",{className:"relative",children:e.jsx($s,{listSize:s})})},ca=()=>{const t=P(o=>o.loading),s=w(o=>o.language),[a,n]=N.useState("actions"),r=o=>{t||a===o||n(o)},i=o=>v("text-xs 2xl:text-sm truncate flex items-center justify-center gap-1 flex-1 h-7 2xl:h-10 px-2 rounded-md transition-all duration-200 font-medium leading-none transform-gpu will-change-transform motion-reduce:transform-none",!t&&"hover:scale-[0.98] active:scale-[0.96] active:opacity-80",t&&"opacity-50 cursor-not-allowed",o?"bg-[var(--filter-btn-active-bg)] text-[var(--filter-btn-active-text)] shadow-sm":"text-[var(--primary-strong)] bg-[var(--view-btn-inactive-bg)]");return e.jsxs("div",{className:"flex flex-col gap-1 bg-[var(--eem-bg-secondary)] p-2 rounded-md h-fit",children:[e.jsxs("div",{className:"w-full flex items-center rounded-md gap-1",children:[e.jsxs("button",{type:"button","aria-pressed":a==="actions",className:i(a==="actions"),onClick:t?void 0:()=>r("actions"),disabled:t,children:[e.jsx(ct,{className:"text-inherit"}),e.jsx("span",{className:"font-bold",children:s.switch_acoes})]}),e.jsxs("button",{type:"button","aria-pressed":a==="fastResponse",className:i(a==="fastResponse"),onClick:t?void 0:()=>r("fastResponse"),disabled:t,children:[e.jsx(Lt,{className:"text-inherit"}),e.jsx("span",{className:"font-bold",children:s.switch_respostas_rapidas})]})]}),a==="actions"?e.jsx(oa,{}):e.jsx(la,{})]})},C=17,da={txt:e.jsx(rs,{size:C}),image:e.jsx(ns,{size:C}),video:e.jsx(as,{size:C}),audio:e.jsx(ss,{size:C}),doc:e.jsx(ts,{size:C}),sticker:e.jsx(es,{size:C}),respostaRapida:e.jsx(Zt,{size:C}),addCRM:e.jsx(Qt,{size:C}),removeCRM:e.jsx(Jt,{size:C}),removeAllCRM:e.jsx(Ue,{size:C}),addLabel:e.jsx(We,{size:C}),removeLabel:e.jsx(We,{size:C}),removeAllLabel:e.jsx(Ue,{size:C}),timer:e.jsx(Yt,{size:C}),composing:e.jsx(Xt,{size:C}),recording:e.jsx(Kt,{size:C}),arquivar:e.jsx(Be,{size:C}),desarquivar:e.jsx(Be,{size:C}),fixarChat:e.jsx(Ht,{size:C}),desfixarChat:e.jsx(Wt,{size:C}),marcarNaoLido:e.jsx(Ut,{size:C}),transferir:e.jsx(Bt,{size:C}),bloquear:e.jsx(qt,{size:C}),pix:e.jsx(Vt,{size:C}),groupInvite:e.jsx(Gt,{size:C}),contact:e.jsx(Ot,{size:C}),linkPreview:e.jsx($t,{size:C}),list:e.jsx(Rt,{size:C})},ma=t=>da[t]??e.jsx(Mt,{size:C}),ae=({action:t})=>e.jsx("div",{className:"w-5 h-5 flex-shrink-0 rounded-md flex items-center justify-center",children:e.jsx("span",{className:"inline-flex items-center justify-center",children:ma(t.type)})}),xa=({action:t,index:s})=>{const a=w(l=>l.language),n="p-1 2xl:p-1.5 rounded-md bg-[color-mix(in_srgb,var(--primaria)_30%,white)] shadow-md text-black font-semibold flex items-center gap-2",r="flex items-center justify-center size-4 2xl:size-5 rounded-full bg-[var(--primaria)] text-black text-xs flex-shrink-0",i="flex-1 flex items-center gap-2 min-w-0",o="truncate text-xs 2xl:text-sm",d="p-1 2xl:p-1.5 rounded-md bg-gray-100 shadow-md text-gray-500 font-normal flex items-center gap-2 border-2 border-dashed border-gray-300",x=l=>e.jsxs("div",{className:d,children:[e.jsx("div",{className:"flex items-center justify-center size-5 2xl:size-6 rounded-full !bg-gray-400 !text-white text-xs 2xl:text-sm flex-shrink-0",children:s+1}),e.jsx("div",{className:i,children:e.jsx("span",{className:v("text-gray-500 italic",o),children:l})})]}),m=l=>{var p,g,u;switch(l.type){case"txt":{const{mensagem:c}=l.propriedades;return c!=null&&c.trim()?e.jsxs("div",{className:n,children:[e.jsx("div",{className:r,children:s+1}),e.jsxs("div",{className:i,children:[e.jsx(ae,{action:l}),e.jsx("span",{className:o,children:c})]})]}):x(a.action_item_mensagem_vazia)}case"image":{const{base64:c,mensagem:b}=l.propriedades;return c?e.jsxs("div",{className:n,children:[e.jsx("div",{className:r,children:s+1}),e.jsxs("div",{className:i,children:[e.jsx("div",{className:"2xl:size-8 size-7 flex-shrink-0 overflow-hidden rounded-md",children:e.jsx("img",{src:c,alt:b??"imagem",className:"w-full h-full object-cover"})}),b&&e.jsx("span",{className:o,children:b})]})]}):x(a.action_item_imagem_nao_encontrada)}case"video":{const{base64:c,mensagem:b}=l.propriedades;return c?e.jsxs("div",{className:n,children:[e.jsx("div",{className:r,children:s+1}),e.jsxs("div",{className:i,children:[e.jsx("div",{className:"2xl:size-8 size-7 flex-shrink-0 overflow-hidden rounded-md",children:e.jsx("video",{src:c,className:"w-full h-full object-cover"})}),b&&e.jsx("span",{className:o,children:b})]})]}):x(a.action_item_video_nao_encontrado)}case"audio":{const{base64:c}=l.propriedades;return c?e.jsxs("div",{className:n,children:[e.jsx("div",{className:r,children:s+1}),e.jsxs("div",{className:i,children:[e.jsx(ae,{action:l}),e.jsx("div",{className:"w-full max-w-xs min-w-0",children:e.jsx("audio",{controls:!0,src:c,className:"w-full h-4"})})]})]}):x(a.action_item_audio_nao_encontrado)}case"doc":{const{base64:c,base64Name:b}=l.propriedades;return!c||!b?x(a.action_item_documento_nao_encontrado):e.jsxs("div",{className:n,children:[e.jsx("div",{className:r,children:s+1}),e.jsxs("div",{className:i,children:[e.jsx(ae,{action:l}),e.jsx("span",{className:o,children:b})]})]})}case"sticker":{const{base64:c}=l.propriedades;return c?e.jsxs("div",{className:n,children:[e.jsx("div",{className:r,children:s+1}),e.jsxs("div",{className:i,children:[e.jsx("div",{className:"2xl:size-8 size-7 flex-shrink-0 overflow-hidden rounded-md",children:e.jsx("img",{src:c,alt:"sticker",className:"w-full h-full object-cover"})}),e.jsx("div",{className:o,children:a.action_item_criar_sticker})]})]}):x(a.action_item_sticker_nao_encontrado)}case"respostaRapida":{const{respostaRapidaID:c}=l.propriedades;return c!=null&&c.trim()?e.jsxs("div",{className:n,children:[e.jsx("div",{className:r,children:s+1}),e.jsxs("div",{className:i,children:[e.jsx(ae,{action:l}),e.jsx("span",{className:o,children:a.action_item_resposta_rapida})]})]}):x(a.action_item_resposta_rapida_nao_selecionada)}case"addCRM":case"removeCRM":case"removeAllCRM":case"addLabel":case"removeLabel":case"removeAllLabel":case"timer":case"composing":case"recording":case"arquivar":case"desarquivar":case"fixarChat":case"desfixarChat":case"marcarNaoLido":case"bloquear":case"groupInvite":case"contact":case"linkPreview":case"transferir":case"pix":{const c=l.propriedades;let b="";switch(l.type){case"addCRM":b=`${a.action_item_adicionar_crm}${c.crmID?`: ${c.crmID}`:""}${c.abaID?` (${a.action_item_aba}: ${c.abaID})`:""}`;break;case"removeCRM":b=`${a.action_item_remover_crm}${c.crmID?`: ${c.crmID}`:""}${c.abaID?` (${a.action_item_aba}: ${c.abaID})`:""}`;break;case"removeAllCRM":b=a.action_item_remover_todos_crms;break;case"addLabel":b=`${a.action_item_adicionar_etiqueta}: ${c.labelID||a.action_item_sem_id}`;break;case"removeLabel":b=`${a.action_item_remover_etiqueta}: ${c.labelID||a.action_item_sem_id}`;break;case"removeAllLabel":b=a.action_item_remover_todas_etiquetas;break;case"timer":b=c.segundos?`${a.action_item_aguardar_segundos} ${c.segundos} ${a.action_item_segundos}`:a.action_item_timer_sem_duracao;break;case"composing":b=c.segundos?`${a.action_item_digitando_por} ${c.segundos} ${a.action_item_segundos}`:a.action_item_tempo_digitacao_nao_definido;break;case"recording":b=c.segundos?`${a.action_item_gravando_por} ${c.segundos} ${a.action_item_segundos}`:a.action_item_tempo_gravacao_nao_definido;break;case"arquivar":b=a.action_item_arquivar_contato;break;case"desarquivar":b=a.action_item_desarquivar_contato;break;case"fixarChat":b=a.action_item_fixar_conversa;break;case"desfixarChat":b=a.action_item_desfixar_conversa;break;case"marcarNaoLido":b=a.action_item_marcar_nao_lido;break;case"bloquear":b=a.action_item_bloquear_contato;break;case"groupInvite":b=a.action_item_convite_grupo;break;case"contact":b=c.userName?`${c.userName} - ${c.userID??""}`:a.action_item_contato_sem_nome;break;case"linkPreview":b=c.title||c.link||a.action_item_link;break;case"transferir":if(!((p=c.email)!=null&&p.trim()))return x(a.action_item_email_transferencia_nao_definido);b=`${a.action_item_transferir_para}: ${c.email}${c.urgencia?` (${a.action_item_urgente})`:""}${c.mensagem?` - ${c.mensagem}`:""}`;break;case"pix":if(!((g=c.key)!=null&&g.trim())||!((u=c.name)!=null&&u.trim()))return x(a.action_item_dados_pix_incompletos);b=`${a.action_item_pix} (${c.keyType}): ${c.name} - ${c.key}`;break;default:b=`${l.type}`}return e.jsxs("div",{className:n,children:[e.jsx("div",{className:r,children:s+1}),e.jsxs("div",{className:i,children:[e.jsx(ae,{action:l}),e.jsx("span",{className:o,children:b})]})]})}default:return x(`${a.action_item_acao}: ${l.type}`)}};return e.jsx(e.Fragment,{children:m(t)})},ua="/assets/png/Whatsbg.chunk.png",pa=()=>{const t=w(n=>n.language),s=h(n=>n.campaigns.find(r=>r.id===n.currentCampaignId)),a=(s==null?void 0:s.actions)||[];return e.jsxs("div",{style:{backgroundImage:`url(${chrome.runtime.getURL(`content/${ua}`)})`},className:"flex flex-col p-3 2xl:p-4 rounded-md overflow-hidden h-[43dvh] overflow-y-auto transition-all duration-200",children:[e.jsxs("div",{className:"flex items-center gap-1 2xl:gap-2 w-full text-[var(--primaria)] font-bold mb-3 2xl:mb-4",children:[e.jsx(Le,{className:"2xl:text-2xl text-lg"}),e.jsx("h2",{className:"2xl:text-lg text-sm",children:t.preview_titulo})]}),e.jsx("div",{className:"flex-1 flex flex-col gap-1.5 2xl:gap-2 overflow-y-auto",children:a.map((n,r)=>e.jsx(xa,{action:n,index:r},n.id))})]})},ga=()=>{const t=w(p=>p.language),s=h(p=>p.campaigns.find(g=>g.id===p.currentCampaignId)),a=h(p=>p.updateConfig),n="range !range-xs w-full",r="font-medium label p-0";if(!s)return null;const i=p=>{a(s.id,{interval:{...s.config.interval,seconds:parseInt(p)}})},o=p=>{a(s.id,{pause:{...s.config.pause,every:parseInt(p)}})},d=p=>{a(s.id,{pause:{...s.config.pause,durationSeconds:parseInt(p)}})},x=p=>{const g=p.target.checked;a(s.id,{signature:{...s.config.signature,disabled:g,useCustomName:g?!1:s.config.signature.useCustomName,customName:g?void 0:s.config.signature.customName}})},m=p=>{const g=p.target.checked;a(s.id,{signature:{...s.config.signature,useCustomName:g,customName:g?s.config.signature.customName:void 0}})},l=p=>{a(s.id,{signature:{...s.config.signature,customName:p.trim()||void 0}})};return e.jsxs("div",{className:"w-full !text-xs 2xl:!text-sm",children:[e.jsxs("div",{title:t.campaign_settings_intervalo_tooltip,children:[e.jsxs("div",{className:"flex justify-between items-center mb-0.5",children:[e.jsx("label",{className:"font-medium",children:t.campaign_settings_intervalo}),e.jsxs("span",{className:"font-semibold",children:[s.config.interval.seconds," ",t.campaign_settings_segundos]})]}),e.jsx("input",{type:"range",min:1,max:60,value:s.config.interval.seconds,onChange:p=>i(p.target.value),className:n,style:{zoom:"75%"}})]}),e.jsxs("div",{title:t.campaign_settings_pausa_tooltip,children:[e.jsxs("div",{className:"flex justify-between items-center mb-0.5",children:[e.jsx("label",{className:"font-medium",children:t.campaign_settings_pausa_a_cada}),e.jsxs("span",{className:"font-semibold",children:[s.config.pause.every," ",t.campaign_settings_contatos]})]}),e.jsx("input",{type:"range",min:1,max:50,value:s.config.pause.every,onChange:p=>o(p.target.value),className:n,style:{zoom:"75%"}})]}),e.jsxs("div",{title:t.campaign_settings_tempo_pausa_tooltip,children:[e.jsxs("div",{className:"flex justify-between items-center mb-0.5",children:[e.jsx("label",{className:"font-medium",children:t.campaign_settings_tempo_pausa}),e.jsxs("span",{className:"font-semibold",children:[s.config.pause.durationSeconds," ",t.campaign_settings_segundos]})]}),e.jsx("input",{type:"range",min:5,max:300,value:s.config.pause.durationSeconds,onChange:p=>d(p.target.value),className:n,style:{zoom:"75%"}})]}),e.jsx("div",{className:"mb-1",title:t.campaign_settings_desativar_tooltip,children:e.jsxs("label",{className:r,children:[t.campaign_settings_desativar_assinatura,e.jsx(He,{id:"disable-signature",estado:s.config.signature.disabled,switchUpdate:x,zoom:{zoom:"60%"}})]})}),!s.config.signature.disabled&&e.jsx("div",{className:"mb-1",title:t.campaign_settings_personalizar_tooltip,children:e.jsxs("label",{className:r,children:[t.campaign_settings_personalizar_nome,e.jsx(He,{id:"custom-signature-name",estado:s.config.signature.useCustomName,switchUpdate:m,zoom:{zoom:"60%"}})]})}),s.config.signature.useCustomName&&!s.config.signature.disabled&&e.jsx("div",{title:t.campaign_settings_nome_tooltip,children:e.jsxs("fieldset",{className:"fieldset",children:[e.jsx("legend",{className:"fieldset-legend",children:t.campaign_settings_nome_assinatura}),e.jsx("input",{type:"text",className:`input 2xl:input-sm input-xs input-bordered w-full
                           2xl:placeholder:!text-sm placeholder:!text-xs`,placeholder:t.campaign_settings_digite_nome,value:s.config.signature.customName||"",onChange:p=>l(p.target.value)})]})})]})},ba=()=>{const t=w(n=>n.language),s=h(n=>n.campaigns.find(r=>r.id===n.currentCampaignId)),a=(s==null?void 0:s.actions)||[];return e.jsxs(e.Fragment,{children:[e.jsx(_e,{title:t.step_actions_titulo,subtitle:t.step_actions_subtitulo}),e.jsxs("div",{className:"grid grid-cols-[30%_minmax(300px,1fr)_23%] gap-2 2xl:gap-4",children:[e.jsx(ca,{}),e.jsx(ia,{}),a.length>0&&e.jsxs("div",{className:"flex flex-col gap-2 bg-[var(--eem-bg-secondary)] p-2 rounded-md h-fit",children:[e.jsx(pa,{}),e.jsx(ga,{})]})]})]})},X=F((t,s)=>({activeFilter:{type:"filter",id:"savedContacts"},setActiveFilter:a=>{t({activeFilter:{type:"filter",id:a}})},setActiveGroupment:a=>{t({activeFilter:{type:"groupment",id:a}})}})),Ne=F()(me(t=>({groupments:[],addGroupment:s=>t(a=>({groupments:[...a.groupments,s]})),removeGroupment:s=>t(a=>({groupments:a.groupments.filter(n=>n.id!==s)}))}),{name:"useGroupments-store",version:1,partialize:t=>({groupments:t.groupments})}));function fa(t){const s=w.getState().language,a=we(t);return a.endsWith("@c.us")?s.user_type_contato:a.endsWith("@g.us")?s.user_type_grupo:a.endsWith("lid")?s.user_type_contato:s.user_type_desconhecido}function ha(t){var s;return(s=t.id)==null?void 0:s.startsWith("1313555")}async function va(t){if(t.name)return t.name;try{const s=await S.Contact("get",we(t.id));return(s==null?void 0:s.name)||(s==null?void 0:s.pushname)||t.id}catch(s){return console.warn(`Erro ao buscar contato ${t.id}:`,s),t.id}}function ja(t){var n;const s=[t["First Name"],t["Middle Name"],t["Last Name"]].map(r=>r==null?void 0:r.trim()).filter(Boolean).join(" ");if(s)return s;const a=["Nickname","Organization Name"].map(r=>{var i;return(i=t[r])==null?void 0:i.trim()}).find(Boolean);return a||((n=t.name)!=null&&n.trim()?t.name.trim():"")}const ya=t=>t.map(a=>({id:a.id||a["Phone 1 - Value"],name:ja(a)})),Se=F()(me(t=>({importedContacts:[],setImportedContacts:s=>{const a=ya(s);t({importedContacts:a})}}),{name:"useImportedContactsStore-store",version:1,partialize:t=>({importedContacts:t.importedContacts})})),Na=()=>{const[t,s]=N.useState("filters"),a=P(j=>j.loading),n=X(j=>j.activeFilter),{setActiveFilter:r,setActiveGroupment:i}=X.getState(),o=Ne(j=>j.groupments),d=Ne(j=>j.removeGroupment),x=Se.getState().setImportedContacts,m=h(j=>j.campaigns.find(M=>M.id===j.currentCampaignId)),l=(m==null?void 0:m.selectedContacts)||[],p=D.getState().open,g=j=>{n.type==="filter"&&n.id===j||r(j)},u=()=>{p(e.jsx(vt,{list:j=>x(j)}))},c=j=>{n.type==="groupment"&&n.id===j||i(j)},b=j=>{a||t===j||s(j)},y=[{id:"savedContacts",type:"filter",label:"Contatos Salvos",onClick:()=>g("savedContacts")},{id:"inbox",type:"filter",label:"Inbox",onClick:()=>g("inbox")},{id:"labels",type:"filter",label:"Etiquetas",onClick:()=>g("labels")},{id:"groups",type:"filter",label:"Grupos",onClick:()=>g("groups")},{id:"groupContacts",type:"filter",label:"Contatos de grupos",onClick:()=>g("groupContacts")},{id:"crmOrTabs",type:"filter",label:"CRMs / Abas",onClick:()=>g("crmOrTabs")},{id:"contactProfile",type:"filter",label:"Perfil do contato",onClick:()=>g("contactProfile")},{id:"importSpreadsheet",type:"filter",label:"Importar planilha",onClick:()=>g("importSpreadsheet")}],f=o.map(j=>({id:j.id,type:"groupment",label:j.name,onClick:()=>c(j.id)})),k=t==="filters"?y:f,L=j=>v("text-xs 2xl:text-sm truncate flex items-center justify-center gap-1 flex-1 h-7 2xl:h-10 px-2 rounded-md transition-all duration-200 font-medium leading-none transform-gpu will-change-transform motion-reduce:transform-none",!a&&"hover:scale-[0.98] active:scale-[0.96] active:opacity-80",a&&"opacity-50 cursor-not-allowed",j?"bg-[var(--filter-btn-active-bg)] text-[var(--filter-btn-active-text)] shadow-sm":"text-[var(--primary-strong)] bg-[var(--view-btn-inactive-bg)]"),A=j=>v("text-xs 2xl:text-base font-medium w-full text-left h-7 2xl:h-10 rounded-md transition-transform duration-200 border border-solid flex items-center justify-between px-1.5 leading-tight transform-gpu will-change-transform motion-reduce:transform-none",j?"bg-[var(--filter-btn-active-bg)] text-[var(--filter-btn-active-text)]":"border-[var(--filter-btn-inactive-border-color)] bg-[var(--filter-btn-inactive-bg)] hover:scale-[0.98]",a&&!j&&"opacity-50 cursor-not-allowed hover:scale-100");return e.jsxs("div",{className:"flex flex-col items-start gap-1 bg-[var(--eem-bg-secondary)] p-2 rounded-md h-fit",children:[e.jsxs("div",{className:"w-full flex items-center rounded-md gap-1",children:[e.jsxs("button",{className:L(t==="filters"),onClick:a?void 0:()=>b("filters"),disabled:a,children:[e.jsx(dt,{className:"text-inherit"}),e.jsx("span",{className:"font-bold",children:"Filtros"}),e.jsx("div",{className:"badge badge-xs 2xl:badge-sm badge-soft text-white bg-[var(--primaria)]",children:y.length})]}),e.jsxs("button",{className:L(t==="groups"),onClick:a?void 0:()=>b("groups"),disabled:a,children:[e.jsx(is,{className:"text-inherit"}),e.jsx("span",{className:"font-bold",children:"Agrupamentos"}),e.jsx("div",{className:"badge badge-xs 2xl:badge-sm badge-soft text-white bg-[var(--primaria)]",children:f.length})]})]}),e.jsxs("div",{className:"flex flex-col gap-1 w-full max-h-[50dvh] overflow-y-auto p-[0.5px]",children:[k.map(j=>{const M=n.type===j.type&&n.id===j.id,ue=j.id==="importSpreadsheet",pe=j.type==="groupment";return e.jsxs("button",{className:A(M),onClick:a&&!M?void 0:j.onClick,disabled:a&&!M,children:[e.jsx("span",{className:"truncate flex-1",children:j.label}),a&&M&&e.jsx(O,{className:"text-sm 2xl:text-base animate-spin"}),ue&&!a&&e.jsxs("button",{type:"button",title:"Importar Planilha",className:"rounded-md text-xs 2xl:text-base px-2 gap-1 transition-all active:scale-95 flex items-center justify-center border border-solid duration-200 hover:scale-[0.98]",onClick:()=>u(),children:["Importar",e.jsx(mt,{})]}),pe&&!a&&e.jsx("button",{type:"button",title:"Remover Agrupamento",className:"2xl:size-6 size-5 rounded-md transition-all active:scale-95 text-red-500 flex items-center justify-center border border-solid duration-200 hover:scale-[0.98]",onClick:ge=>{ge.stopPropagation(),d(j.id)},children:e.jsx(Me,{className:"2xl:text-base text-sm"})})]},`${j.type}-${j.id}`)}),t==="groups"&&f.length===0&&e.jsxs("div",{className:"text-center text-xs 2xl:text-base py-2 2xl:py-4 px-1.5 2x:px-2 border border-dotted italic rounded-md",children:["Nenhum agrupamento criado ainda.",e.jsx("br",{}),"Crie agrupamentos a partir dos destinatários selecionados."]})]}),e.jsxs("button",{className:`mt-1 text-xs 2xl:text-base w-full truncate flex items-center justify-center gap-1 p-1.5 
        rounded-md transition-all duration-200 font-medium leading-none transform-gpu 
        motion-reduce:transform-none hover:scale-[0.98] active:scale-[0.96] will-change-transform 
        active:opacity-80 text-[var(--primary-strong)] bg-[var(--view-btn-inactive-bg)]`,onClick:()=>Os(l),children:[e.jsx(os,{}),e.jsx("span",{className:"font-medium",children:"Exportar Contatos Selecionados (.XLSX)"})]})]})},xe=({contact:t,className:s="",size:a="md"})=>{var u;const[n,r]=N.useState(!1),i=["bg-red-500","bg-blue-500","bg-green-500","bg-yellow-500","bg-purple-500","bg-pink-500","bg-orange-500","bg-indigo-500","bg-teal-500"],o={xs:"w-6 h-6 text-xs",sm:"w-8 h-8 text-xs",md:"w-10 h-10 text-sm",lg:"w-12 h-12 text-base"},d=t.id.charCodeAt(0)%i.length,x=i[d],m=`${o[a]} rounded-full ${s} border border-solid border-[var(--contact-img-border-color)]`;function l(c){const b=c.match(/[A-Za-zÀ-ÖØ-öø-ÿ]/);if(b)return b[0].toUpperCase();const y=c.match(/\d/);return y?y[0]:"?"}const p=(u=t.name)!=null&&u.trim()?t.name.trim():t.phone||t.id;return t.avatarUrl&&t.avatarUrl!=="undefined"&&t.avatarUrl.trim()&&!n?e.jsx("img",{src:t.avatarUrl,alt:t.name,className:`${m} object-cover`,onError:()=>r(!0)}):e.jsx("div",{className:`${m} flex items-center justify-center ${x}`,children:e.jsx("span",{className:"text-white font-semibold",children:l(p)})})},Ca=({contact:t,virtualItem:s})=>{const{breakpoint:a}=G(),n=h(p=>p.currentCampaignId),r=h(p=>p.campaigns),{updateCampaign:i}=h.getState(),o=r.find(p=>p.id===n),d=(o==null?void 0:o.selectedContacts.some(p=>p.id===t.id))||!1,x=fa(t.id),m=a==="2xl"?"md":"sm",l=()=>{if(!o)return;const p=d?o.selectedContacts.filter(g=>g.id!==t.id):[...o.selectedContacts,t];i(o.id,{selectedContacts:p})};return e.jsx("div",{className:"absolute top-0 left-0 w-full will-change-transform",style:{height:s.size,transform:`translateY(${s.start}px)`},children:e.jsxs("label",{htmlFor:`contact-checkbox-${t.id}`,className:`w-full h-full py-1 2xl:py-1.5 px-2 2xl:px-3 flex items-center gap-1 2xl:gap-2 
        bg-[var(--contact-card-bg)] rounded-md cursor-pointer
        transition-all duration-200 hover:scale-[1.01] hover:opacity-90
        active:scale-[0.98] active:opacity-90`,style:{border:"1px solid var(--sidebar-line-color)"},children:[e.jsx("input",{id:`contact-checkbox-${t.id}`,type:"checkbox",checked:d,onChange:l,className:"checkbox checkbox-xs 2xl:checkbox-sm checkbox-neutral"}),e.jsx(xe,{contact:t,size:m}),e.jsxs("div",{className:"flex flex-col w-10/12",children:[e.jsx("span",{className:"text-xs 2xl:text-base font-medium truncate",children:t.name}),e.jsxs("span",{className:"2xl:text-xs text-[10px] text-[var(--light-text-color)]",children:[e.jsx("strong",{children:"Tipo:"})," ",x]})]})]})})},wa=K.memo(Ca),le=F(t=>({activeLabel:"all",setActiveLabel:s=>t({activeLabel:s})}));let fe=null;const _a=300*1e3,Sa=()=>{var g;const[t,s]=N.useState([]),a=P(u=>u.loading),n=N.useRef(null),r=le(u=>u.activeLabel),i=le.getState().setActiveLabel,o=E(u=>u.modalOptions),{open:d,close:x}=E.getState();N.useEffect(()=>{const u=Date.now();if(fe&&u-fe.timestamp<_a){s(fe.data);return}S.Labels("getAllLabels").then(c=>{s(c),fe={data:c,timestamp:u}}).catch(c=>console.error("Erro ao buscar labels:",c))},[]);const m=()=>{var u;return e.jsxs("div",{className:"flex flex-col rounded-md max-h-[42vh] overflow-hidden",style:{width:(u=n.current)==null?void 0:u.offsetWidth},children:[e.jsx("div",{className:"sticky top-0 px-3 py-2",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("span",{className:"text-sm font-medium text-gray-600",children:t.length===0?"Nenhuma etiqueta disponível":t.length===1?`${t.length} Etiqueta disponível`:`${t.length} Etiquetas disponíveis`})})}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-2 py-1",children:[t.length>0&&e.jsxs("div",{className:v("flex items-center gap-1 2xl:gap-2 px-2 2xl:px-3 py-1 2xl:py-2 my-0.5 text-xs 2xl:text-sm cursor-pointer rounded-md transition-colors",{"dark:bg-neutral-700 bg-neutral-300":r==="all"},{"hover:bg-[var(--view-btn-inactive-bg)]":r!=="all"}),onClick:()=>{i("all"),x()},children:[e.jsx(Ae,{className:"flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"Todas as etiquetas"})]}),t.map(({id:c,name:b})=>e.jsxs("div",{className:v("flex items-center gap-1 2xl:gap-2 px-2 2xl:px-3 py-1 2xl:py-2 my-0.5 text-xs 2xl:text-sm cursor-pointer rounded-md transition-colors",{"dark:bg-neutral-700 bg-neutral-300":r===c},{"hover:bg-[var(--view-btn-inactive-bg)]":r!==c}),onClick:()=>{i(c),x()},children:[e.jsx(ls,{className:"flex-shrink-0"}),e.jsx("span",{className:"truncate",children:b})]},c)),t.length===0&&!a&&e.jsx("div",{className:"flex items-center justify-center py-6 text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ae,{className:"text-2xl mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Nenhuma etiqueta encontrada"})]})})]})]})},l=u=>{u.stopPropagation(),o?x():d(e.jsx(m,{}),{placement:"bottom"},u.currentTarget)},p=a?"Carregando etiquetas...":t.length===0?"Nenhuma etiqueta disponível":r==="all"?"Todas as etiquetas":((g=t.find(u=>u.id===r))==null?void 0:g.name)||"Selecione uma etiqueta";return e.jsx("div",{className:"w-full",children:e.jsxs("button",{ref:n,onClick:l,disabled:a,className:v("w-full flex items-center justify-between gap-1 2xl:gap-2 px-2 2xl:px-3 py-1","2xl:py-2 text-xs 2xl:text-sm rounded-md transition-all duration-200 border",a?"cursor-not-allowed opacity-60":"cursor-pointer hover:scale-[1.01] active:opacity-80",o?"bg-[var(--view-btn-inactive-bg)]":"bg-[var(--filter-btn-inactive-bg)] hover:bg-[var(--view-btn-inactive-bg)]","border-solid border-[var(--sidebar-line-color)]"),children:[e.jsxs("div",{className:"flex items-center gap-1 2xl:gap-2",children:[a?e.jsx(O,{className:"text-sm 2xl:text-lg text-[var(--primary-strong)] animate-spin"}):e.jsx(Ae,{className:"text-sm 2xl:text-lg text-[var(--primary-strong)]"}),e.jsx("span",{className:"truncate font-medium text-[var(--primary-strong)]",children:p})]}),!a&&e.jsx(oe,{className:v("text-sm 2xl:text-lg text-[var(--primary-strong)] transform transition-transform",{"rotate-180":o})})]})})},Ce=F(t=>({activeGroup:"all",setActiveGroup:s=>t({activeGroup:s})}));let he=null;const ka=300*1e3,Aa=()=>{var g;const[t,s]=N.useState([]),a=P(u=>u.loading),n=N.useRef(null),r=Ce(u=>u.activeGroup),i=Ce.getState().setActiveGroup,o=E(u=>u.modalOptions),{open:d,close:x}=E.getState();N.useEffect(()=>{const u=Date.now();if(he&&u-he.timestamp<ka){s(he.data);return}S.Group("getAllGroups").then(c=>{const b=c.filter(y=>y.name).sort((y,f)=>y.name.localeCompare(f.name));s(b),he={data:b,timestamp:Date.now()}}).catch(c=>console.error("Erro ao buscar grupos:",c))},[]);const m=()=>{var u;return e.jsxs("div",{className:"flex flex-col rounded-md max-h-[42vh] overflow-hidden",style:{width:(u=n.current)==null?void 0:u.offsetWidth},children:[e.jsx("div",{className:"sticky top-0 px-3 py-2",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("span",{className:"text-xs 2xl:text-sm font-medium text-gray-600",children:t.length===0?"Nenhum grupo disponível":t.length===1?`${t.length} Grupo disponível`:`${t.length} Grupos disponíveis`})})}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-2 py-1",children:[t.length>0&&e.jsxs("div",{className:v("flex items-center gap-1 2xl:gap-2 px-2 2xl:px-3 py-1 2xl:py-2 my-0.5 text-xs 2xl:text-sm cursor-pointer rounded-md transition-all duration-200",{"dark:bg-neutral-700 bg-neutral-300":r==="all"},{"hover:bg-[var(--view-btn-inactive-bg)]":r!=="all"}),onClick:()=>{i("all"),x()},children:[e.jsx(Pe,{className:"flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"Todos os grupos"})]}),t.map(({id:c,name:b})=>e.jsxs("div",{className:v("flex items-center gap-1 2xl:gap-2 px-2 2xl:px-3 py-1 2xl:py-2 my-0.5 text-xs 2xl:text-sm cursor-pointer rounded-md transition-all duration-200",{"dark:bg-neutral-700 bg-neutral-300":r===c},{"hover:bg-[var(--view-btn-inactive-bg)]":r!==c}),onClick:()=>{i(c),x()},children:[e.jsx(xt,{className:"flex-shrink-0"}),e.jsx("span",{className:"truncate",children:b})]},c.toString())),t.length===0&&!a&&e.jsx("div",{className:"flex items-center justify-center py-6 text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Pe,{className:"text-2xl mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Nenhum grupo encontrado"})]})})]})]})},l=u=>{u.stopPropagation(),o?x():d(e.jsx(m,{}),{placement:"bottom"},u.currentTarget)},p=a?"Carregando grupos...":t.length===0?"Nenhum grupo disponível":r==="all"?"Todos os grupos":((g=t.find(u=>u.id===r))==null?void 0:g.name)||"Selecione um grupo";return e.jsx("div",{className:"w-full",children:e.jsxs("button",{ref:n,onClick:l,disabled:a,className:v("w-full flex items-center justify-between gap-1 2xl:gap-2 px-2 2xl:px-3 py-1","2xl:py-2 text-xs 2xl:text-sm rounded-md transition-all duration-200 border",a?"cursor-not-allowed opacity-60":"cursor-pointer hover:scale-[1.01] active:opacity-80",o?"bg-[var(--view-btn-inactive-bg)]":"bg-[var(--filter-btn-inactive-bg)] hover:bg-[var(--view-btn-inactive-bg)]","border-solid border-[var(--sidebar-line-color)]"),children:[e.jsxs("div",{className:"flex items-center gap-1 2xl:gap-2",children:[a?e.jsx(O,{className:"text-sm 2xl:text-lg text-[var(--primary-strong)] animate-spin"}):e.jsx(Pe,{className:"text-sm 2xl:text-lg text-[var(--primary-strong)]"}),e.jsx("span",{className:"truncate font-medium text-[var(--primary-strong)]",children:p})]}),!a&&e.jsx(oe,{className:v("text-sm 2xl:text-lg text-[var(--primary-strong)] transform transition-transform",{"rotate-180":o})})]})})},Q=F(t=>({activeCrm:"all",setActiveCrm:s=>t({activeCrm:s})})),Z=F((t,s)=>({activeSwitch:"tab",setActiveSwitch:a=>{s().activeSwitch!==a&&t({activeSwitch:a})}})),ce=F(t=>({activeCrmTab:"all",setActiveCrmTab:s=>t({activeCrmTab:s}),resetActiveCrmTab:()=>t({activeCrmTab:"all"})})),de=F(t=>({activeUserTab:"all",setActiveUserTab:s=>t({activeUserTab:s})}));function Ge(){const{crm:t}=Re.getState(),{userTabs:s}=$e.getState(),{activeCrm:a}=Q.getState(),{activeCrmTab:n}=ce.getState(),{activeSwitch:r}=Z.getState(),{activeUserTab:i}=de.getState();return{crms:t,activeCrm:a,activeSwitch:r,activeCrmTab:n,activeUserTab:i,userTabs:s}}const wt=()=>{const{crms:t,activeCrm:s,activeSwitch:a}=Ge();if(a!=="crm"||s==="all")return[];const n=t.find(r=>r.id===s);return(n==null?void 0:n.list)||[]},et=t=>{const{loading:s}=P.getState();return v("flex flex-1 items-center text-xs 2xl:text-sm justify-center gap-1 py-0.5 2xl:py-1 rounded-md transition-all duration-200 font-medium",!s&&"hover:scale-[1.02] active:scale-95 active:opacity-80",s&&"opacity-50 cursor-not-allowed",t?"bg-[var(--filter-btn-active-bg)] text-[var(--filter-btn-active-text)] shadow-sm border border-[var(--filter-btn-active-bg)]":"text-[var(--primary-strong)] bg-[var(--view-btn-inactive-bg)]")},Pa=()=>{var o;const{loading:t}=P.getState(),{crms:s,activeCrm:a,activeCrmTab:n}=Ge();if(t)return"Carregando...";if(n==="all")return`Todas as abas do CRM: ${((o=s.find(x=>x.id===a))==null?void 0:o.name)||""}`;const i=wt().find(d=>d.id===n);return(i==null?void 0:i.name)||"Selecione uma aba"},Fa=()=>{var o,d;const{activeSwitch:t,activeCrm:s,activeUserTab:a,crms:n,userTabs:r}=Ge(),{loading:i}=P.getState();if(i)return"Carregando...";if(t==="crm")return s==="all"?"Todos os CRMs":((o=n.find(x=>x.id===s))==null?void 0:o.name)||"Selecione um CRM";if(t==="tab")return a==="all"?"Todas as abas":((d=r.find(x=>x.id===a))==null?void 0:d.tag)||"Selecione uma aba"},Ta=({crmTabsFilterRef:t})=>{var o;const s=wt(),a=ce(d=>d.activeCrmTab),n=ce.getState().setActiveCrmTab,r=P(d=>d.loading),i=E.getState().close;return e.jsx("div",{className:"flex flex-col rounded-md max-h-[42vh] overflow-hidden",style:{width:(o=t.current)==null?void 0:o.offsetWidth},children:e.jsxs("div",{className:"flex-1 overflow-y-auto px-2 py-1",children:[e.jsxs("div",{className:v("flex items-center gap-1 2xl:gap-2 px-2 2xl:px-3 py-1 2xl:py-2 my-0.5 text-xs 2xl:text-sm cursor-pointer rounded-md",{"dark:bg-neutral-700 bg-neutral-300":a==="all"},{"hover:bg-[var(--view-btn-inactive-bg)]":a!=="all"}),onClick:()=>{n("all"),i()},children:[e.jsx(W,{className:"flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"Todas as abas"})]}),s.map(d=>e.jsxs("div",{className:v("flex items-center gap-1 2xl:gap-2 px-2 2xl:px-3 py-1 2xl:py-2 my-0.5 text-xs 2xl:text-sm cursor-pointer rounded-md",{"dark:bg-neutral-700 bg-neutral-300":a===d.id,"hover:bg-[var(--view-btn-inactive-bg)]":a!==d.id}),onClick:()=>{n(d.id),i()},children:[e.jsx(W,{className:"flex-shrink-0"}),e.jsx("span",{className:"truncate",children:d.name})]},d.id)),s.length===0&&!r&&e.jsx("div",{className:"flex items-center justify-center py-6 text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx(W,{className:"text-2xl mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Nenhuma aba encontrada"})]})})]})})},Ia=({mainFilterRef:t})=>{var y;const s=$e(f=>f.userTabs),a=de(f=>f.activeUserTab),n=de.getState().setActiveUserTab,r=Z(f=>f.activeSwitch),i=P(f=>f.loading),o=Re(f=>f.crm),d=Q(f=>f.activeCrm),x=Q.getState().setActiveCrm,m=E.getState().close,l=r==="crm",p=l?o:s,g=l?d:a,u=l?x:n,c=l?"Todos os CRMs":"Todas as abas",b=l?Ee:W;return e.jsx("div",{className:"flex flex-col rounded-md max-h-[42vh] overflow-hidden",style:{width:(y=t.current)==null?void 0:y.offsetWidth},children:e.jsxs("div",{className:"flex-1 overflow-y-auto px-2 py-1",children:[e.jsxs("div",{className:v("flex items-center gap-1 2xl:gap-2 px-2 2xl:px-3 py-1 2xl:py-2 my-0.5 text-xs 2xl:text-sm cursor-pointer rounded-md",{"dark:bg-neutral-700 bg-neutral-300":g==="all"},{"hover:bg-[var(--view-btn-inactive-bg)]":g!=="all"}),onClick:()=>{u("all"),m()},children:[e.jsx(b,{className:"flex-shrink-0"}),e.jsx("span",{className:"truncate",children:c})]}),p.map(f=>{const k="name"in f?f.name:f.tag;return e.jsxs("div",{className:v("flex items-center gap-1 2xl:gap-2 px-2 2xl:px-3 py-1 2xl:py-2 my-0.5 text-xs 2xl:text-sm cursor-pointer rounded-md",{"dark:bg-neutral-700 bg-neutral-300":g===f.id,"hover:bg-[var(--view-btn-inactive-bg)]":g!==f.id}),onClick:()=>{u(f.id),m()},children:[e.jsx(b,{className:"flex-shrink-0"}),e.jsx("span",{className:"truncate",children:k})]},f.id)}),p.length===0&&!i&&e.jsx("div",{className:"flex items-center justify-center py-6 text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx(b,{className:"text-2xl mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Nenhum item encontrado"})]})})]})})},Ea=()=>{const t=Z(c=>c.activeSwitch),s=Z.getState().setActiveSwitch,a=P(c=>c.loading),n=N.useRef(null),r=N.useRef(null),{open:i,close:o}=E.getState(),d=E(c=>c.modalOptions),x=Q(c=>c.activeCrm),m=c=>{a||t===c||(s(c),o())},l=(c,b="main")=>{c.stopPropagation(),b==="main"?d?o():i(e.jsx(Ia,{mainFilterRef:n}),{placement:"bottom"},c.currentTarget,5):d?o():i(e.jsx(Ta,{crmTabsFilterRef:r}),{placement:"bottom"},c.currentTarget,5)},p=d&&n.current===document.activeElement,g=d&&r.current===document.activeElement,u=t==="crm"&&x!=="all";return e.jsxs("div",{className:"w-full flex flex-col gap-1 2xl:gap-2 2xl:mt-1",children:[e.jsxs("div",{className:"w-full flex gap-1 2xl:gap-2 items-center",children:[e.jsxs("button",{className:et(t==="tab"),onClick:a?void 0:()=>m("tab"),disabled:a,children:[e.jsx(W,{}),e.jsx("span",{className:"font-bold",children:"Abas"})]}),e.jsxs("button",{className:et(t==="crm"),onClick:a?void 0:()=>m("crm"),disabled:a,children:[e.jsx(Ee,{}),e.jsx("span",{className:"font-bold",children:"CRMs"})]})]}),e.jsxs("button",{ref:n,onClick:c=>l(c,"main"),disabled:a,className:v("w-full flex items-center justify-between gap-1 2xl:gap-2 px-2 2xl:px-3 py-1 2xl:py-2 text-xs 2xl:text-sm cursor-pointer border rounded-md transition-all duration-200",a?"cursor-not-allowed opacity-60 bg-gray-100":"cursor-pointer hover:scale-[1.01] active:opacity-80",p?"bg-[var(--view-btn-inactive-bg)]":"bg-[var(--filter-btn-inactive-bg)] hover:bg-[var(--view-btn-inactive-bg)]","border-solid border-[var(--sidebar-line-color)]"),children:[e.jsxs("div",{className:"flex items-center gap-1 2xl:gap-2",children:[a?e.jsx(O,{className:"text-sm 2xl:text-lg text-[var(--primary-strong)] animate-spin"}):t==="tab"?e.jsx(W,{className:"text-sm 2xl:text-lg text-[var(--primary-strong)]"}):e.jsx(Ee,{className:"text-sm 2xl:text-lg text-[var(--primary-strong)]"}),e.jsx("span",{className:"truncate font-medium text-[var(--primary-strong)]",children:Fa()})]}),!a&&e.jsx(oe,{className:v("text-sm 2xl:text-lg text-[var(--primary-strong)] transform transition-transform",{"rotate-180":p})})]}),u&&e.jsxs("button",{ref:r,onClick:c=>l(c,"crmTabs"),disabled:a,className:v("w-full flex items-center justify-between gap-1 2xl:gap-2 px-2 2xl:px-3 py-1 2xl:py-2 text-xs 2xl:text-sm cursor-pointer border rounded-md transition-all duration-200",a?"cursor-not-allowed opacity-60 bg-gray-100":"cursor-pointer hover:scale-[1.01] active:opacity-80",g?"bg-[var(--view-btn-inactive-bg)]":"bg-[var(--filter-btn-inactive-bg)] hover:bg-[var(--view-btn-inactive-bg)]","border-solid border-[var(--sidebar-line-color)]"),children:[e.jsxs("div",{className:"flex items-center gap-1 2xl:gap-2",children:[a?e.jsx(O,{className:"text-sm 2xl:text-lg text-[var(--primary-strong)] animate-spin"}):e.jsx(W,{className:"text-sm 2xl:text-lg text-[var(--primary-strong)]"}),e.jsx("span",{className:"truncate font-medium text-[var(--primary-strong)]",children:Pa()})]}),!a&&e.jsx(oe,{className:v("text-sm 2xl:text-lg text-[var(--primary-strong)] transform transition-transform",{"rotate-180":g})})]})]})},Ie={gender:null,birthDate:null,city:null,state:null,leadSource:null,entryDate:null,exitDate:null,company:null,jobTitle:null,interestedProducts:[]},$=F()(me((t,s)=>({tempFilters:Ie,appliedFilters:Ie,currentProduct:"",updateTempField:(a,n)=>{t(r=>({tempFilters:{...r.tempFilters,[a]:n}}))},setCurrentProduct:a=>{t({currentProduct:a})},addProduct:()=>{const{currentProduct:a,tempFilters:n}=s(),r=a.trim();r&&!n.interestedProducts.includes(r)&&t(i=>({tempFilters:{...i.tempFilters,interestedProducts:[...i.tempFilters.interestedProducts,r]},currentProduct:""}))},removeProduct:a=>{t(n=>({tempFilters:{...n.tempFilters,interestedProducts:n.tempFilters.interestedProducts.filter(r=>r!==a)}}))},clearTempFilters:()=>{t({tempFilters:Ie,currentProduct:""})},applyFilters:()=>{const{tempFilters:a}=s();t({appliedFilters:a})}}),{name:"advanced-filters-eem",version:1,partialize:t=>({tempFilters:t.tempFilters,appliedFilters:t.appliedFilters})})),R=({id:t,label:s,type:a="text",placeholder:n,options:r,grid:i=!1})=>{const o=$(l=>l.tempFilters),d=$(l=>l.updateTempField),x=o[t]||"",m=l=>{d(t,l||null)};return e.jsxs("div",{className:`space-y-1 ${i?"flex-1":""}`,children:[e.jsx("label",{htmlFor:t,className:"block text-sm font-semibold",children:s}),r?e.jsxs("select",{id:t,value:x,onChange:l=>m(l.target.value),className:"select select-sm !leading-none w-full border border-solid border-[var(--fallback-bc,oklch(var(--bc)/.2))]",children:[e.jsx("option",{value:"",children:n||`Selecione ${s.toLowerCase()}`}),r.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))]}):e.jsx("input",{id:t,type:a,placeholder:n,className:"input input-sm input-bordered w-full border border-solid transition-all duration-200",value:x,onChange:l=>m(l.target.value)})]})},za=[{value:"AC",label:"Acre"},{value:"AL",label:"Alagoas"},{value:"AP",label:"Amapá"},{value:"AM",label:"Amazonas"},{value:"BA",label:"Bahia"},{value:"CE",label:"Ceará"},{value:"DF",label:"Distrito Federal"},{value:"ES",label:"Espírito Santo"},{value:"GO",label:"Goiás"},{value:"MA",label:"Maranhão"},{value:"MT",label:"Mato Grosso"},{value:"MS",label:"Mato Grosso do Sul"},{value:"MG",label:"Minas Gerais"},{value:"PA",label:"Pará"},{value:"PB",label:"Paraíba"},{value:"PR",label:"Paraná"},{value:"PE",label:"Pernambuco"},{value:"PI",label:"Piauí"},{value:"RJ",label:"Rio de Janeiro"},{value:"RN",label:"Rio Grande do Norte"},{value:"RS",label:"Rio Grande do Sul"},{value:"RO",label:"Rondônia"},{value:"RR",label:"Roraima"},{value:"SC",label:"Santa Catarina"},{value:"SP",label:"São Paulo"},{value:"SE",label:"Sergipe"},{value:"TO",label:"Tocantins"}],Da=[{value:"whatsapp",label:"WhatsApp"},{value:"youtube",label:"YouTube"},{value:"facebook",label:"Facebook"},{value:"instagram",label:"Instagram"},{value:"linkedin",label:"LinkedIn"},{value:"tiktok",label:"TikTok"},{value:"google",label:"Google"},{value:"site",label:"Site"},{value:"formulario",label:"Formulário"},{value:"crm",label:"CRM"},{value:"outros",label:"Outros"}],La=[{value:"male",label:"Masculino"},{value:"female",label:"Feminino"}],Ma=()=>{const t=$(o=>o.tempFilters),s=$(o=>o.currentProduct),{setCurrentProduct:a,addProduct:n,removeProduct:r}=$.getState(),i=o=>{o.key==="Enter"&&(o.preventDefault(),s.trim()&&n())};return e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-semibold",children:"Digite um produto de interesse"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("input",{type:"text",placeholder:"Digite um produto de interesse",className:"input input-sm input-bordered flex-1 border border-solid transition-all duration-200",value:s,onChange:o=>a(o.target.value),onKeyDown:i}),e.jsx("button",{type:"button",onClick:n,className:"bg-[var(--primaria)] text-white p-2 rounded-md",children:"Adicionar"})]}),t.interestedProducts.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-semibold",children:"Produtos selecionados:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.interestedProducts.map((o,d)=>e.jsxs("button",{type:"button",title:"Remover produto",onClick:()=>r(o),className:`bg-gray-100 dark:bg-gray-700 px-3 py-1 rounded-full text-sm flex items-center
                gap-2 hover:scale-105 active:scale-90 cursor-pointer transition-all duration-150`,children:[e.jsx("span",{className:"truncate flex-1 min-w-0",children:o}),e.jsx(cs,{className:"text-red-500 hover:text-red-600 cursor-pointer flex-shrink-0 w-4 h-4"})]},d))})]})]})},Ra=()=>{const{applyFilters:t,clearTempFilters:s}=$.getState(),a=n=>{n.preventDefault(),t(),D.getState().close(),I({type:"Success",message:"Filtros aplicados com sucesso!"})};return e.jsxs("div",{className:"w-[520px] max-h-[92vh] overflow-y-auto",children:[e.jsx(ut,{children:"Filtragem Avançada"}),e.jsxs("form",{className:"space-y-3 mt-3",onSubmit:n=>n.preventDefault(),children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(R,{id:"gender",label:"Gênero",options:La,grid:!0}),e.jsx(R,{id:"birthDate",label:"Data de Nascimento",type:"date",grid:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(R,{id:"city",label:"Cidade",placeholder:"Digite a cidade",grid:!0}),e.jsx(R,{id:"state",label:"Estado",options:za,grid:!0})]}),e.jsx(R,{id:"leadSource",label:"Origem do Lead",options:Da}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(R,{id:"entryDate",label:"Data de Entrada",type:"date",grid:!0}),e.jsx(R,{id:"exitDate",label:"Data de Saída",type:"date",grid:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(R,{id:"company",label:"Empresa",placeholder:"Nome da empresa",grid:!0}),e.jsx(R,{id:"jobTitle",label:"Cargo",placeholder:"Ex: Gerente, Diretor, Analista",grid:!0})]}),e.jsx(Ma,{}),e.jsxs("div",{className:"pt-2 w-full flex justify-center gap-3",children:[e.jsx(Ke,{type:"reset",name:"Limpar",funcao:s},"clearTempFilters"),e.jsx(Ke,{type:"submit",name:"Filtrar",funcao:a},"applyFilters")]})]})]})},J=F()(me((t,s)=>({options:[{key:"all"},{key:"birthdaysThisMonth"},{key:"genderMale"},{key:"genderFemale"}],selectedOption:"all",setSelectedOption:a=>{s().selectedOption!==a&&t({selectedOption:a})}}),{name:"useProfilesOptions-store",version:1,partialize:t=>({selectedOption:t.selectedOption})}));function _t(t){return{all:"Todos os contatos",birthdaysThisMonth:"Aniversariantes do mês",genderMale:"Sexo masculino",genderFemale:"Sexo feminino"}[t]??"Opção desconhecida"}function St(t){const s="text-sm 2xl:text-base flex-shrink-0";return{all:e.jsx(Xe,{className:s}),birthdaysThisMonth:e.jsx(xs,{className:s}),genderMale:e.jsx(ms,{className:s}),genderFemale:e.jsx(ds,{className:s})}[t]??e.jsx(Xe,{className:s})}const $a=({profileOptionsRef:t})=>{var i;const s=J(o=>o.options),a=J(o=>o.selectedOption),n=J.getState().setSelectedOption,r=E.getState().close;return e.jsx("div",{className:"flex flex-col rounded-md max-h-[42vh] overflow-hidden",style:{width:(i=t.current)==null?void 0:i.offsetWidth},children:e.jsx("div",{className:"flex-1 overflow-y-auto px-2 py-0.5 2xl:py-1",children:s.map(o=>e.jsxs("div",{className:v("flex items-center gap-1 2xl:gap-2 px-2 2xl:px-3 py-1 2xl:py-2 my-0.5 text-xs 2xl:text-sm cursor-pointer rounded-md",{"dark:bg-neutral-700 bg-neutral-300":o.key===a,"hover:bg-[var(--view-btn-inactive-bg)]":o.key!==a}),onClick:()=>{n(o.key),r()},children:[St(o.key),e.jsx("span",{className:"truncate",children:_t(o.key)})]},o.key))})})},Oa=()=>{const t=N.useRef(null),s=N.useRef(null),a=$(m=>m.appliedFilters),n=Object.values(a).filter(m=>(m==null?void 0:m.length)??m).length,r=P(m=>m.loading),i=E(m=>m.modalOptions),o=()=>{const{open:m}=D.getState();m(e.jsx(Ra,{}))},d=m=>{const{open:l,close:p}=E.getState();i?p():l(e.jsx($a,{profileOptionsRef:s}),{placement:"bottom"},m.currentTarget,5)},x=J(m=>m.selectedOption);return e.jsxs("div",{className:"w-full flex items-center gap-1 2xl:gap-2",children:[e.jsxs("button",{type:"button",ref:s,onClick:d,disabled:r,className:v("w-full flex items-center justify-between px-1.5 2xl:px-3 py-1 2xl:py-2 border rounded-md transition-all duration-200",r?"cursor-not-allowed opacity-60 bg-gray-100":"cursor-pointer hover:scale-[1.01] active:opacity-80",i?"bg-[var(--view-btn-inactive-bg)]":"bg-[var(--filter-btn-inactive-bg)] hover:bg-[var(--view-btn-inactive-bg)]","border-solid border-[var(--sidebar-line-color)]"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[r?e.jsx(O,{className:"text-sm 2xl:text-lg text-[var(--primary-strong)] animate-spin"}):St(x),e.jsx("span",{className:"truncate text-xs 2xl:text-base font-medium text-[var(--primary-strong)]",children:_t(x)})]}),!r&&e.jsx(oe,{className:v("text-sm 2xl:text-lg text-[var(--primary-strong)] transform transition-transform",{"rotate-180":i})})]}),e.jsx("button",{type:"button",ref:t,title:"Abrir filtragem avançada",onClick:o,disabled:r,className:v("w-fit flex items-center justify-between px-1.5 2xl:px-3 py-1 2xl:py-2 border rounded-md transition-all duration-200",r?"cursor-not-allowed opacity-60 bg-gray-100":"cursor-pointer hover:scale-[1.01] active:opacity-80","bg-[var(--filter-btn-inactive-bg)] hover:bg-[var(--view-btn-inactive-bg)]","border-solid border-[var(--sidebar-line-color)]"),children:e.jsxs("div",{className:"flex items-center gap-1 2xl:gap-2",children:[r?e.jsx(O,{className:"text-sm 2xl:text-lg text-[var(--primary-strong)] animate-spin"}):e.jsx(dt,{className:"text-sm 2xl:text-lg text-[var(--primary-strong)]"}),e.jsxs("div",{className:"truncate text-xs 2xl:text-base font-medium text-[var(--primary-strong)]",children:[e.jsxs("span",{children:["Filtragem avançada"," "]}),e.jsx("div",{className:"badge badge-xs 2xl:badge-sm badge-outline bg-[var(--primaria)]",children:n})]})]})})]})},Ga=()=>{const t=X(a=>a.activeFilter);return{savedContacts:null,inbox:null,labels:e.jsx(Sa,{}),groups:null,groupContacts:e.jsx(Aa,{}),crmOrTabs:e.jsx(Ea,{}),contactProfile:e.jsx(Oa,{}),importSpreadsheet:null}[t.id]||null},Va=()=>{const t=Se.getState().setImportedContacts,s=D.getState().open,a=()=>{s(e.jsx(vt,{list:n=>t(n)}))};return e.jsxs("button",{type:"button",title:"Importar Planilha",className:"rounded-md text-xs 2xl:text-sm px-2 py-1 gap-1 transition-all active:scale-95 flex items-center justify-center border border-solid duration-200 hover:scale-[0.98]",onClick:()=>a(),children:["Importar Contatos",e.jsx(mt,{})]})},qa=()=>{const t=X(a=>a.activeFilter);return{savedContacts:null,inbox:null,labels:null,groups:null,groupContacts:null,crmOrTabs:null,contactProfile:null,importSpreadsheet:e.jsx(Va,{})}[t.id]||null},Ba=()=>{const[t,s]=N.useState(""),a=P(f=>f.contacts),n=P(f=>f.loading),r=h(f=>f.currentCampaignId),i=h(f=>f.campaigns),{updateCampaign:o}=h.getState(),d=i.find(f=>f.id===r),x=(d==null?void 0:d.selectedContacts)||[],m=N.useMemo(()=>{if(!t.trim())return a;const f=t.toLowerCase();return a.filter(k=>{var L,A;return((L=k.name)==null?void 0:L.toLowerCase().includes(f))||((A=k.phone)==null?void 0:A.toLowerCase().includes(f))})},[a,t]),{breakpoint:l}=G(),p={estimateSize:l==="2xl"?70:44,gap:l==="2xl"?8:4,padding:l==="2xl"?8:4},g=K.useRef(null),u=Oe({count:m.length,getScrollElement:()=>g.current,estimateSize:()=>p.estimateSize,paddingStart:p.padding,paddingEnd:p.padding,gap:p.gap,overscan:10}),c=u.getTotalSize(),b=u.getVirtualItems(),y=()=>{if(!d)return;const f=new Set(m.map(A=>A.id)),L=m.every(A=>x.some(j=>j.id===A.id))?x.filter(A=>!f.has(A.id)):[...x,...m.filter(A=>!x.some(j=>j.id===A.id))];o(d.id,{selectedContacts:L})};return e.jsxs("div",{className:"bg-[var(--eem-bg-secondary)] p-2 rounded-md h-fit",children:[e.jsxs("div",{className:"w-full flex gap-1 2xl:gap-2 h-8 2xl:h-11 items-stretch px-1 2xl:px-2",children:[e.jsxs("div",{className:"relative flex-1 h-full",children:[e.jsx(us,{className:"absolute text-base 2xl:text-xl left-3 top-1/2 transform -translate-y-1/2 text-black"}),e.jsx("input",{role:"search",type:"text",placeholder:"Pesquisar por nome ou número",value:t,onChange:f=>s(f.target.value),className:v("w-full pl-8 2xl:pl-10 h-full border text-sm 2xl:text-base rounded-md","bg-[var(--search-bg-color)] text-black","placeholder:!text-sm 2xl:placeholder:!text-base placeholder:!text-slate-500")})]}),e.jsxs("button",{onClick:y,className:`w-fit px-2 flex items-center justify-center rounded-md 
             h-full bg-[var(--selectAll-btn-bg-color)] hover:bg-[var(--selectAll-btn-hover-bg)] 
             text-white text-sm 2xl:text-base transition-all duration-150
             hover:scale-[1.02] active:scale-95 active:opacity-80
             border border-solid border-[var(--eem-border-primary)]`,children:[e.jsx(ps,{className:"text-white text-base 2xl:text-xl"}),e.jsx("span",{className:"ml-1 font-medium",children:m.every(f=>x.some(k=>k.id===f.id))?"Desmarcar tudo":"Selecionar tudo"})]})]}),e.jsx("div",{className:"w-full px-1 2xl:px-2 py-1",children:e.jsx(Ga,{})}),e.jsx("div",{className:"w-full px-2 pb-2 border-b-2 border-solid border-[var(--sidebar-line-color)]",children:n&&a.length===0?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{className:"text-xs 2xl:text-base animate-spin"}),e.jsx("span",{className:"text-xs 2xl:text-base",children:"Carregando destinatários..."})]}):e.jsx("p",{className:"2xl:text-base text-xs",children:`${a.length} destinatários disponíveis • ${x.length} selecionados`})}),e.jsx("div",{className:"w-full overflow-auto max-h-[40dvh] px-1",ref:g,children:n&&a.length===0?e.jsx("div",{className:"flex h-[38vh] justify-center items-center",children:e.jsx(O,{size:48,className:"animate-spin"})}):m.length===0?e.jsxs("div",{className:"flex flex-col h-[36dvh] justify-center items-center text-gray-600 dark:text-gray-400",children:[e.jsx(gs,{className:"2xl:mb-3 mb-1 opacity-60 text-3xl 2xl:text-4xl"}),e.jsx("p",{className:"text-base 2xl:text-lg font-medium 2xl:mb-1",children:t.trim()?"Nenhum destinatário encontrado":"Nenhum destinatário disponível"}),e.jsx("p",{className:"text-xs 2xl:text-sm text-center max-w-xs mb-1",children:t.trim()?"Tente ajustar os termos de busca ou filtros":a.length===0?"Não existe destinatários disponíveis aqui":"Seus destinatários do WhatsApp aparecerão aqui"}),e.jsx(qa,{})]}):e.jsx("div",{style:{height:c,position:"relative"},children:b.map(f=>{const k=m[f.index];return k?e.jsx(wa,{contact:k,virtualItem:f},k.id):null})})})]})},Ua=({selectedContact:t,virtualItem:s})=>{const{breakpoint:a}=G(),n=h(m=>m.currentCampaignId),r=h(m=>m.campaigns),{updateCampaign:i}=h.getState(),o=r.find(m=>m.id===n),d=a==="2xl"?"sm":"xs",x=m=>{if(!o)return;const l=o.selectedContacts.filter(p=>p.id!==m);i(o.id,{selectedContacts:l})};return e.jsx("div",{className:"absolute top-0 left-0 w-full will-change-transform",style:{height:s.size,transform:`translateY(${s.start}px)`},children:e.jsxs("label",{htmlFor:`selectedContact-${t.id}`,className:`flex items-center justify-between bg-[var(--contact-card-bg)] rounded-md p-1 border border-solid
        border-[var(--sidebar-line-color)] cursor-pointer hover:scale-[1.02] active:scale-95 active:opacity-80 transition-all duration-200`,title:"Remover contato",children:[e.jsxs("div",{className:"flex items-center gap-1.5 2xl:gap-3 w-10/12",children:[e.jsx(xe,{contact:t,size:d}),e.jsx("p",{className:"text-xs 2xl:text-base font-medium truncate flex-1",children:t.name})]}),e.jsx("button",{id:`selectedContact-${t.id}`,className:`hover:bg-[var(--view-btn-inactive-bg)] hover:scale-[1.04] active:scale-90
          active:opacity-80 p-1 2xl:p-1.5 rounded-md transition-all duration-200 text-red-500`,onClick:()=>x(t.id),children:e.jsx(Me,{className:"text-sm 2xl:text-xl"})})]},t.id)})},tt={contactId:"",name:"",surname:"",syncAdressBook:!0},st={isChecking:!1,isValid:null,message:""},H=F(t=>({formData:tt,validation:st,setFormData:s=>t(a=>({formData:{...a.formData,...s}})),setValidation:s=>t(()=>({validation:s})),resetForm:()=>t(()=>({formData:tt,validation:st}))})),Wa=()=>{const t=H(n=>n.validation);if(!t.message)return null;const s=()=>{const n="flex items-center gap-2 mt-2 text-sm";return t.isChecking?`${n} text-base-content/60`:t.isValid===!1?`${n} text-error`:t.isValid===!0?`${n} text-success`:n},a=()=>t.isChecking?e.jsx("span",{className:"loading loading-spinner loading-xs"}):t.isValid===!1?e.jsx(bs,{className:"w-4 h-4"}):t.isValid===!0?e.jsx(fs,{className:"w-4 h-4"}):null;return e.jsxs("div",{className:s(),children:[a(),e.jsx("span",{children:t.message})]})},Ha=()=>{const t=H(n=>n.validation),s=t.isChecking||t.isValid===!1||!t.message.trim(),a=`
    w-full mt-6 px-6 py-3 
    bg-gray-900 hover:bg-gray-800 active:bg-gray-950 
    dark:bg-gray-100 dark:hover:bg-gray-200 dark:active:bg-gray-50 
    text-white dark:text-gray-900 
    font-medium rounded-xl 
    transition-all duration-200 ease-out 
    flex items-center justify-center gap-2 
    shadow-lg hover:shadow-xl 
    dark:shadow-gray-200/20 dark:hover:shadow-gray-200/30 
    transform hover:-translate-y-0.5 active:translate-y-0 
    focus:outline-none focus:ring-2 focus:ring-gray-500 
    dark:focus:ring-gray-400 focus:ring-offset-2 
    dark:focus:ring-offset-gray-800 
    disabled:opacity-50 disabled:cursor-not-allowed 
    disabled:transform-none group
  `.replace(/\s+/g," ").trim();return e.jsx("button",{type:"submit",disabled:s,className:a,children:t.isChecking?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"loading loading-spinner loading-sm"}),e.jsx("span",{className:"tracking-wide",children:"Verificando..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(hs,{className:"w-4 h-4 transition-transform duration-200 group-hover:scale-110"}),e.jsx("span",{className:"tracking-wide",children:"Criar e Adicionar Contato"})]})})};let ie=null;const Ka=500,Xa=t=>{const{setValidation:s}=H.getState();ie&&clearTimeout(ie),s({isChecking:!1,isValid:null,message:""});const a=t.replace(/\D/g,"");a.trim()&&(ie=setTimeout(async()=>{s({isChecking:!0,isValid:null,message:"Verificando número..."});try{const[n]=await Promise.all([S.Contact("queryExists",a),new Promise(r=>setTimeout(r,Ka))]);s({isChecking:!1,isValid:n&&n!=="undefined",message:n&&n!=="undefined"?"Número válido e existe no WhatsApp":"Este número não existe no WhatsApp ou é inválido"})}catch{s({isChecking:!1,isValid:!1,message:"Erro ao verificar o número. Tente novamente."})}},1e3))},Ya=()=>{ie&&clearTimeout(ie)},Ja=async()=>{const{formData:t}=H.getState(),{currentCampaignId:s,campaigns:a,updateCampaign:n}=h.getState();try{const r=a.find(u=>u.id===s);if(!r)return I({type:"Error",message:"Nenhuma campanha ativa encontrada."}),!1;const i={contactId:t.contactId,name:t.name,options:{surname:t.surname,syncAdressBook:t.syncAdressBook}},o=await S.Contact("save",i);if(!o||typeof o=="string"&&o==="undefined")return I({type:"Error",message:"Não foi possível salvar o contato. Verifique se o número está correto e ativo no WhatsApp."}),!1;const d=o.id.toString(),x=await S.Contact("getProfilePictureUrl",d).catch(()=>null),m=x&&x!=="undefined"?x:null,l={id:d,name:o.name,phone:vs(d),avatarUrl:m};if(r.selectedContacts.some(u=>u.id===l.id))return I({type:"Error",message:"Este contato já está na campanha atual."}),!1;const g=[...r.selectedContacts,l];return n(r.id,{selectedContacts:g}),I({type:"Success",message:"Contato adicionado com sucesso à campanha!"}),!0}catch(r){return console.error("Erro ao criar contato:",r),I({type:"Error",message:"Ocorreu um erro ao criar o contato."}),!1}},Qa=()=>{const t=H(x=>x.formData),s=H(x=>x.validation),{setFormData:a,resetForm:n}=H.getState(),{close:r}=D.getState(),i=(x,m)=>{x==="contactId"&&typeof m=="string"?(a({contactId:m}),Xa(m)):a({[x]:m})},o=async x=>{if(x.preventDefault(),s.isValid===!1)return;await Ja()&&(r(),n())},d=()=>{const x="!input !input-bordered !pl-14 !focus:input-neutral";return s.isValid===!1?`${x} !input-error`:s.isValid===!0?`${x} !input-success`:x};return N.useEffect(()=>()=>{Ya()},[]),e.jsxs("form",{onSubmit:o,className:"space-y-2",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-medium",children:"Número do WhatsApp"})}),e.jsx(Gs,{value:t.contactId,setValue:x=>i("contactId",x),inputClass:d(),buttonStyle:{marginTop:"9px",paddingLeft:"10px"},placeholder:"Digite o número do WhatsApp",preferredCountries:["in","br","ar","us","id","mx","ru","pk","ng"],enableSearch:!0,searchPlaceholder:"Buscar país",searchNotFound:"País não encontrado",inputProps:{name:"whatsapp",required:!0,autoFocus:!0}}),e.jsx(Wa,{})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-medium",children:"Nome"})}),e.jsx("input",{type:"text",value:t.name,onChange:x=>i("name",x.target.value),placeholder:"João",className:"input input-bordered focus:input-neutral",required:!0})]}),e.jsxs("div",{className:"form-control",children:[e.jsx("label",{className:"label",children:e.jsx("span",{className:"label-text font-medium",children:"Sobrenome"})}),e.jsx("input",{type:"text",value:t.surname,onChange:x=>i("surname",x.target.value),placeholder:"Silva",className:"input input-bordered focus:input-neutral"})]})]}),e.jsx("div",{className:"form-control",children:e.jsxs("label",{className:"label cursor-pointer justify-start gap-3",children:[e.jsx("input",{type:"checkbox",checked:t.syncAdressBook,onChange:x=>i("syncAdressBook",x.target.checked),className:"checkbox checkbox-neutral checkbox-sm"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"label-text font-medium",children:"Sincronizar com Google Contatos"}),e.jsx("span",{className:"text-xs text-base-content/60 mt-1",children:t.syncAdressBook?"Contato será salvo no WhatsApp e no Google Contatos":"Contato será salvo apenas no WhatsApp"})]})]})}),e.jsx(Ha,{})]})},Za=()=>e.jsxs("div",{className:"min-w-[450px] bg-base-100 p-3",children:[e.jsx(en,{}),e.jsx(Qa,{})]}),en=()=>e.jsxs("div",{className:"flex flex-col items-center mb-2",children:[e.jsx("div",{className:"avatar placeholder mb-2",children:e.jsx("div",{className:"bg-neutral text-neutral-content rounded-full w-14 h-14",children:e.jsx(js,{className:"w-7 h-7"})})}),e.jsx(ut,{children:"Adicionar novo contato"}),e.jsxs("p",{className:"text-base-content/70 text-center mt-2 text-base leading-relaxed max-w-sm",children:["Crie um contato no WhatsApp e adicione-o"," ",e.jsx("span",{className:"text-[var(--primary-strong)] font-semibold",children:"automaticamente"})," à lista."]})]}),tn=()=>{const[t,s]=K.useState(!1),a=K.useRef(null),n=h(c=>c.currentCampaignId),i=h(c=>c.campaigns).find(c=>c.id===n),{open:o,close:d}=Fs.getState(),x=(i==null?void 0:i.selectedContacts)||[],{addGroupment:m}=Ne.getState(),l=c=>{c.preventDefault();const y=new FormData(c.currentTarget).get("groupmentName");if(!(y!=null&&y.trim()))return;const f={id:lt(),name:y.trim(),contacts:[...x]};m(f),I({type:"Success",message:"Agrupamento criado com sucesso!"}),a.current&&a.current.reset(),s(!1)},p=()=>{s(!1),a.current&&a.current.reset()},g=()=>v("h-full px-1 2xl:px-2 rounded-md bg-[var(--addContact-btn-bg-color)] hover:bg-[var(--addContact-btn-hover-bg)]","text-black transition-all duration-150 gap-1 hover:scale-[1.02] active:scale-95 active:opacity-80","border border-solid border-[var(--eem-border-primary)] flex items-center justify-center"),u=c=>{o("Salve os contatos selecionados em um agrupamento para reutilizá-los depois",{placement:"top"},c.currentTarget)};return x.length===0?null:e.jsx("div",{className:"w-full h-6 2xl:h-8 text-xs 2xl:text-base font-medium",children:t?e.jsxs("form",{className:"w-full h-full flex items-center gap-1",onSubmit:l,ref:a,children:[e.jsx("input",{type:"text",name:"groupmentName",className:`flex-1 px-1.5 2xl:px-2.5 h-full rounded-md border border-solid border-[var(--eem-border-primary)]
              placeholder:!text-xs 2xl:placeholder:!text-base`,placeholder:"Insira o nome do agrupamento",autoFocus:!0}),e.jsx("button",{type:"submit",title:"Criar agrupamento",className:`${g()} w-fit flex items-center justify-center`,children:e.jsx(jt,{fontWeight:800,className:"text-black text-inherit"})}),e.jsx("button",{type:"button",title:"Cancelar criação",onClick:p,className:`${g()} w-fit flex items-center justify-center`,children:e.jsx(yt,{fontWeight:800,className:"text-red-600 text-inherit"})})]}):e.jsxs("button",{type:"button",className:`${g()} w-full`,onClick:()=>s(!0),children:[e.jsx("span",{children:"Criar agrupamento"}),e.jsx("span",{onMouseEnter:u,onMouseLeave:d,onClick:d,children:e.jsx(ys,{})})]})})},sn=()=>{const t=h(u=>u.currentCampaignId),s=h(u=>u.campaigns),{updateCampaign:a}=h.getState(),{open:n}=D.getState(),r=s.find(u=>u.id===t),i=(r==null?void 0:r.selectedContacts)||[],o=()=>{r&&a(r.id,{selectedContacts:[]})},{breakpoint:d}=G(),x={estimateSize:d==="2xl"?37:29,gap:d==="2xl"?8:6,padding:d==="2xl"?8:6},m=K.useRef(null),l=Oe({count:i.length,getScrollElement:()=>m.current,estimateSize:()=>x.estimateSize,paddingStart:x.padding,paddingEnd:x.padding,gap:x.gap,overscan:10}),p=l.getTotalSize(),g=l.getVirtualItems();return e.jsxs("div",{className:"flex flex-col items-center bg-[var(--eem-bg-secondary)] p-2 rounded-md h-fit",children:[e.jsxs("div",{className:"flex items-center justify-between w-full mb-1 2xl:mb-2",children:[e.jsx("h2",{className:"text-xs xl:text-base 2xl:text-lg",children:"Destinatários selecionados"}),e.jsxs("button",{className:`w-fit px-0.5 2xl:px-2 flex items-center justify-center rounded-md 
          bg-[var(--addContact-btn-bg-color)] hover:bg-[var(--addContact-btn-hover-bg)] 
        text-black transition-all duration-150 gap-0.5 2xl:gap-1 text-xs xl:text-base 2xl:text-lg
          hover:scale-[1.02] active:scale-95 active:opacity-80
          border border-solid border-[var(--eem-border-primary)]`,onClick:()=>n(e.jsx(Za,{})),children:[e.jsx(Ns,{className:"text-black"}),e.jsx("span",{className:"font-medium",children:"Adicionar contato"})]})]}),e.jsxs("div",{className:"flex items-center justify-between w-full mb-0.5 text-xs xl:text-base 2xl:text-lg",children:[e.jsx("p",{className:"text-[var(--light-text-color)]",children:`${i.length} ${Cs(i.length,"destinatário","destinatários")}`}),e.jsxs("button",{title:"Limpar tudo",className:`flex items-center gap-0.5 2xl:gap-1 hover:bg-[var(--view-btn-inactive-bg)]
          hover:scale-[1.04] active:scale-90 active:opacity-80 p-1 2xl:p-1.5 transition-all duration-200 rounded-md`,onClick:()=>i.length>0&&o(),children:[e.jsx(Me,{}),e.jsx("span",{className:"font-medium",children:"Limpar"})]})]}),e.jsx("div",{className:"w-full overflow-auto max-h-[36dvh] px-1",ref:m,children:e.jsx("div",{style:{height:p,position:"relative"},children:g.map(u=>{const c=i[u.index];return c?e.jsx(Ua,{selectedContact:c,virtualItem:u},u.key):null})})}),e.jsx("hr",{className:"w-full my-1.5 2xl:my-3 border-1 border-solid border-[var(--eem-border-primary)]"}),e.jsx(tn,{})]})},an=()=>e.jsxs(e.Fragment,{children:[e.jsx(_e,{title:"Selecione os destinatários",subtitle:"Escolha para quem você deseja enviar a mensagem"}),e.jsxs("div",{className:"grid grid-cols-[29%_minmax(300px,1fr)_28%] gap-2 2xl:gap-4",children:[e.jsx(Na,{}),e.jsx(Ba,{}),e.jsx(sn,{})]})]}),Y=({label:t,value:s,className:a=""})=>e.jsxs("div",{className:v("flex justify-between text-xs",a),children:[e.jsx("span",{children:t}),e.jsx("span",{className:"font-medium",children:s})]}),at=t=>t.toLocaleDateString(void 0,{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),nn=(t,s)=>{const a=new Date(s).getTime()-new Date(t).getTime(),n=Math.floor(a/6e4),r=Math.floor(a%6e4/1e3);return n>0?`${n}m ${r}s`:`${r}s`},rn=()=>{const t=h(r=>r.currentCampaignId),{execution:s}=ee(t);if((s==null?void 0:s.status)!==Ds.COMPLETED)return e.jsx("div",{className:"text-center py-8",children:"Os resultados estarão disponíveis após a conclusão das ações."});const a=({value:r,label:i})=>e.jsxs("div",{className:"bg-[var(--result-card-bg-color)] h-full flex-1 flex flex-col items-center justify-center rounded-md",children:[e.jsx("h2",{className:"text-[30px] 2xl:text-[40px] text-[var(--primaria)] font-semibold",children:r}),e.jsx("p",{className:"text-[var(--light-text-color)] text-sm 2xl:text-base",children:i})]}),n=s.totalContacts*s.totalActions;return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2",children:[e.jsx("div",{className:"size-12 2xl:size-16 bg-[#d2fecc] rounded-full flex items-center justify-center",children:e.jsx(ws,{className:"text-green-600 text-[30px] 2xl:text-[40px]"})}),e.jsx("h1",{className:"text-lg 2xl:text-2xl font-medium leading-none",children:"Ações executadas com sucesso!"}),e.jsx("p",{className:"text-sm 2xl:text-lg text-[var(--light-text-color)]",children:"Todas as ações foram executadas para os destinatários selecionados"}),e.jsxs("div",{className:`w-full border border-solid border-[var(--sidebar-line-color)] 
        rounded-md p-2 2xl:p-3 space-y-6 2xl:space-y-12 mt-3 2xl:mt-6`,children:[e.jsxs("div",{className:"flex items-center gap-1.5 2xl:gap-2 text-sm 2xl:text-lg font-medium",children:[e.jsx(_s,{className:"text-base 2xl:text-2xl"}),e.jsx("span",{children:"Resumo da execução"})]}),e.jsxs("div",{className:"flex gap-2 h-32",children:[e.jsx(a,{value:s.totalContacts,label:"Contatos alcançados"}),e.jsx(a,{value:n,label:"Total de ações enviadas"}),e.jsx(a,{value:s.failedCount,label:"Erros no envio"})]}),e.jsxs("div",{className:"space-y-0.5 2xl:space-y-1",children:[e.jsx(Y,{label:"Detalhes",value:"",className:"font-bold"}),e.jsx(Y,{label:"Iniciado em:",value:at(s.startedAt)}),e.jsx(Y,{label:"Concluído em:",value:at(s.completedAt)}),e.jsx(Y,{label:"Tempo total:",value:nn(s.startedAt,s.completedAt)})]})]})]})})},Ve=t=>{const s=w.getState().language;return{txt:{title:s.action_txt_title,description:s.action_txt_desc,icon:null},image:{title:s.action_image_title,description:s.action_image_desc,icon:null},video:{title:s.action_video_title,description:s.action_video_desc,icon:null},audio:{title:s.action_audio_title,description:s.action_audio_desc,icon:null},doc:{title:s.action_doc_title,description:s.action_doc_desc,icon:null},respostaRapida:{title:s.action_respostaRapida_title,description:s.action_respostaRapida_desc,icon:null},addCRM:{title:s.action_addCRM_title,description:s.action_addCRM_desc,icon:null},removeCRM:{title:s.action_removeCRM_title,description:s.action_removeCRM_desc,icon:null},removeAllCRM:{title:s.action_removeAllCRM_title,description:s.action_removeAllCRM_desc,icon:null},addLabel:{title:s.action_addLabel_title,description:s.action_addLabel_desc,icon:null},removeLabel:{title:s.action_removeLabel_title,description:s.action_removeLabel_desc,icon:null},removeAllLabel:{title:s.action_removeAllLabel_title,description:s.action_removeAllLabel_desc,icon:null},timer:{title:s.action_timer_title,description:s.action_timer_desc,icon:null},composing:{title:s.action_composing_title,description:s.action_composing_desc,icon:null},recording:{title:s.action_recording_title,description:s.action_recording_desc,icon:null},arquivar:{title:s.action_arquivar_title,description:s.action_arquivar_desc,icon:null},desarquivar:{title:s.action_desarquivar_title,description:s.action_desarquivar_desc,icon:null},fixarChat:{title:s.action_fixarChat_title,description:s.action_fixarChat_desc,icon:null},desfixarChat:{title:s.action_desfixarChat_title,description:s.action_desfixarChat_desc,icon:null},marcarNaoLido:{title:s.action_marcarNaoLido_title,description:s.action_marcarNaoLido_desc,icon:null},transferir:{title:s.action_transferir_title,description:s.action_transferir_desc,icon:null},bloquear:{title:s.action_bloquear_title,description:s.action_bloquear_desc,icon:null},pix:{title:s.action_pix_title,description:s.action_pix_desc,icon:null},groupInvite:{title:s.action_groupInvite_title,description:s.action_groupInvite_desc,icon:null},contact:{title:s.action_contact_title,description:s.action_contact_desc,icon:null},linkPreview:{title:s.action_linkPreview_title,description:s.action_linkPreview_desc,icon:null},sticker:{title:s.action_sticker_title,description:s.action_sticker_desc,icon:null},list:{title:s.action_list_title,description:s.action_list_desc,icon:null}}[t]},on=()=>{var ue,pe,ge;const[t,s]=N.useState(null);N.useEffect(()=>{async function ke(){const At=await ht();s(At)}ke()},[]);const a=h(ke=>ke.currentCampaignId),{execution:n,isLoading:r,actions:i,isRunning:o,isPaused:d,isCompleted:x,isCancelled:m,campaign:l}=ee(a),{clearExecution:p}=ft.getState(),g=()=>{p(a),(n==null?void 0:n.type)==="test"?i.sendTest():i.sendFull()};if(!l)return e.jsx("div",{className:"text-center py-8",children:"Nenhuma campanha selecionada"});const{breakpoint:u}=G(),c=n?n.currentContactIndex/n.totalContacts*100:0,b=(n==null?void 0:n.type)==="test"?t?[t]:[]:l.selectedContacts,y=n&&n.currentContactIndex<b.length?b[n.currentContactIndex]:null,f=(n==null?void 0:n.currentActionIndex)??0,k=l.actions[f],L=l.actions.length>0?(f+1)/l.actions.length*100:0,A=k?Ve(k.type):null,j=n&&((ue=l.config.pause)==null?void 0:ue.every)>0?l.config.pause.every-n.currentContactIndex%l.config.pause.every:null,M=d&&(n==null?void 0:n.isAutoPause)===!0;return(n==null?void 0:n.type)==="test"&&!t?e.jsx("div",{className:"flex-1 flex flex-col rounded-md border border-solid overflow-hidden bg-[var(--eem-bg-primary)] border-[var(--eem-border-primary)] min-h-0",children:e.jsx("div",{className:"px-4 py-3 border-b border-solid border-[var(--eem-border-primary)] bg-[var(--sidebar-bg-primary)]",children:e.jsx("h3",{className:"font-semibold text-sm",children:"Carregando contatos..."})})}):e.jsxs("div",{className:"flex-1 flex flex-col rounded-md border border-solid overflow-hidden bg-[var(--eem-bg-primary)] border-[var(--eem-border-primary)] min-h-0",children:[n&&e.jsxs("div",{className:"flex-shrink-0 px-3 2xl:px-6 py-2 2xl:py-4 border-b border-solid border-[var(--eem-border-primary)] bg-[var(--sidebar-bg-primary)]",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-semibold text-xs 2xl:text-sm",children:"Progresso"}),e.jsxs("span",{className:"text-xs font-medium opacity-70",children:[n.currentContactIndex," / ",n.totalContacts]})]}),e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("span",{className:"text-xs font-bold",children:[c.toFixed(0),"%"]})}),e.jsx("progress",{className:`progress w-full h-2 ${x?"progress-success":m?"progress-error":d?"progress-warning":"progress-primary"}`,value:n.currentContactIndex,max:n.totalContacts})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto min-h-0",children:[n&&e.jsxs("div",{className:"grid grid-cols-3 divide-x divide-solid border-b border-solid border-[var(--eem-border-primary)] divide-[var(--eem-border-primary)]",children:[e.jsxs("div",{className:"px-2 2xl:px-4 py-1.5 2xl:py-3 text-center",children:[e.jsx("div",{className:"text-sm 2xl:text-2xl font-bold mb-0.5",children:n.currentContactIndex}),e.jsx("div",{className:"text-xs uppercase tracking-wide opacity-60",children:"Contatos Processados"})]}),e.jsxs("div",{className:"px-2 2xl:px-4 py-1.5 2xl:py-3 text-center",children:[e.jsxs("div",{className:"text-sm 2xl:text-2xl font-bold text-success flex items-center justify-center gap-0.5 2xl:gap-1.5 mb-0.5",children:[e.jsx(je,{size:u==="2xl"?20:14}),n.successCount]}),e.jsx("div",{className:"text-xs uppercase tracking-wide opacity-60",children:"Contatos Enviados"})]}),e.jsxs("div",{className:"px-2 2xl:px-4 py-1.5 2xl:py-3 text-center",children:[e.jsxs("div",{className:"text-sm 2xl:text-2xl font-bold text-error flex items-center justify-center gap-0.5 2xl:gap-1.5 mb-0.5",children:[e.jsx(pt,{size:u==="2xl"?20:14}),n.failedCount]}),e.jsx("div",{className:"text-xs uppercase tracking-wide opacity-60",children:"Falhas"})]})]}),e.jsxs("div",{className:"px-2 2xl:px-4 py-1.5 2xl:py-3 border-b border-solid bg-[var(--eem-bg-primary)] border-[var(--eem-border-primary)]",children:[e.jsx("h3",{className:"font-semibold text-xs 2xl:text-sm mb-1 2xl:mb-2",children:"Configurações de Envio"}),e.jsxs("div",{className:"grid grid-cols-2 gap-1.5 2xl:gap-3 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-1 2xl:gap-2",children:[e.jsx(gt,{className:"text-primary flex-shrink-0",size:u==="2xl"?16:12}),e.jsx("div",{children:e.jsxs("div",{className:"font-medium",children:["Intervalo entre contatos ",((pe=l.config.interval)==null?void 0:pe.seconds)||0,"s"]})})]}),(((ge=l.config.pause)==null?void 0:ge.every)||0)>0&&e.jsxs("div",{className:"flex items-center gap-1 2xl:gap-2",children:[e.jsx(ve,{className:"text-warning flex-shrink-0",size:u==="2xl"?16:12}),e.jsx("div",{children:e.jsxs("div",{className:"font-medium",children:["Pausa automática A cada ",l.config.pause.every," contato • ",l.config.pause.durationSeconds,"s"]})})]}),o&&j&&e.jsx("div",{className:"col-span-2 mt-1 p-2 bg-warning/10 rounded-md",children:e.jsxs("div",{className:"text-warning font-medium",children:["Próxima pausa automática em ",j," contato(s)"]})})]})]}),o&&A&&e.jsxs("div",{className:"px-2 2xl:px-4 py-1.5 2xl:py-3 border-b border-solid bg-[var(--sidebar-bg-primary)] border-[var(--eem-border-primary)]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1 2xl:mb-2",children:[e.jsx("h3",{className:"font-semibold text-xs 2xl:text-sm",children:"Ação Atual"}),e.jsxs("span",{className:"text-xs font-medium opacity-70",children:[f+1," / ",l.actions.length]})]}),e.jsxs("div",{className:"flex items-center gap-1.5 2xl:gap-3 mb-1 2xl:mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-xs 2xl:text-sm",children:A.title}),e.jsx("div",{className:"text-xs opacity-70",children:A.description})]}),e.jsx("div",{className:"loading loading-spinner loading-xs 2xl:loading-sm text-primary flex-shrink-0"})]}),e.jsx("progress",{className:"progress progress-primary w-full h-1.5",value:f+1,max:l.actions.length}),e.jsxs("div",{className:"text-xs text-right mt-0.5 2xl:mt-1 opacity-70",children:[L.toFixed(0),"%"]})]}),o&&y&&e.jsx("div",{className:"px-2 2xl:px-4 py-1.5 2xl:py-3 border-b border-solid bg-[var(--sidebar-bg-primary)] border-[var(--eem-border-primary)]",children:e.jsxs("div",{className:"flex items-center gap-1.5 2xl:gap-3",children:[e.jsx("div",{className:"loading loading-spinner loading-xs 2xl:loading-sm text-primary"}),e.jsx(xe,{contact:y,size:u==="2xl"?"sm":"xs"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-semibold text-xs 2xl:text-sm truncate",children:y.name}),e.jsx("div",{className:"text-xs opacity-70 truncate",children:y.phone})]})]})})]}),e.jsx("div",{className:"flex-shrink-0 px-3 2xl:px-6 py-2 2xl:py-4 bg-[var(--eem-bg-primary)]",children:e.jsxs("div",{className:"flex gap-1 2xl:gap-2 justify-center flex-wrap",children:[!n&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:i.sendTest,disabled:r,className:"py-1 px-1.5 flex gap-1 bg-transparent border border-solid hover:opacity-80 rounded-md items-center disabled:opacity-50",children:[e.jsx(Vs,{size:16,className:"flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline whitespace-nowrap",children:"Enviar Teste"})]}),e.jsxs("button",{onClick:i.sendFull,disabled:r||b.length===0,className:"py-1 px-1.5 flex gap-1 bg-transparent border border-solid hover:opacity-80 rounded-md items-center disabled:opacity-50",children:[r?e.jsx(Je,{size:16,className:"flex-shrink-0 animate-spin"}):e.jsx(qs,{size:16,className:"flex-shrink-0"}),e.jsx("span",{className:"whitespace-nowrap",children:"Iniciar Campanha"})]})]}),o&&!M&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:i.pause,className:"py-1 px-1.5 flex gap-1 bg-transparent border border-solid hover:opacity-80 rounded-md items-center disabled:opacity-50",children:[e.jsx(Bs,{size:16,className:"flex-shrink-0"}),e.jsx("span",{className:"whitespace-nowrap",children:"Pausar"})]}),e.jsxs("button",{onClick:i.cancel,className:"py-1 px-1.5 flex gap-1 bg-transparent border border-solid hover:opacity-80 rounded-md items-center disabled:opacity-50",children:[e.jsx(Qe,{size:16,className:"flex-shrink-0"}),e.jsx("span",{className:"whitespace-nowrap",children:"Cancelar"})]})]}),d&&!M&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:i.resume,disabled:r,className:"py-1 px-1.5 flex gap-1 bg-transparent border border-solid hover:opacity-80 rounded-md items-center disabled:opacity-50",children:[r?e.jsx(Je,{size:16,className:"flex-shrink-0 animate-spin"}):e.jsx(Us,{size:16,className:"flex-shrink-0"}),e.jsx("span",{className:"whitespace-nowrap",children:"Continuar"})]}),e.jsxs("button",{onClick:i.cancel,disabled:r,className:"py-1 px-1.5 flex gap-1 bg-transparent border border-solid hover:opacity-80 rounded-md items-center disabled:opacity-50",children:[e.jsx(Qe,{size:16,className:"flex-shrink-0"}),e.jsx("span",{className:"whitespace-nowrap",children:"Cancelar"})]})]}),(x||m)&&e.jsxs("button",{onClick:g,className:"py-1 px-1.5 flex gap-1 bg-transparent border border-solid hover:opacity-80 rounded-md items-center",children:[e.jsx(Ws,{size:16,className:"flex-shrink-0"}),e.jsx("span",{className:"whitespace-nowrap",children:"Enviar Novamente"})]})]})})]})},ln=()=>{const t=h(l=>l.currentCampaignId),{campaign:s,execution:a,isRunning:n}=ee(t),[r,i]=N.useState(null),o=N.useRef(null),{breakpoint:d}=G();N.useEffect(()=>{async function l(){const p=await ht();i(p)}l()},[a]);const x=(a==null?void 0:a.type)==="test"?r?[r]:[]:s.selectedContacts,m=Oe({count:x.length,getScrollElement:()=>o.current,estimateSize:()=>60,overscan:5,gap:8,paddingEnd:8,paddingStart:8});return(a==null?void 0:a.type)==="test"&&!r?e.jsx("div",{className:"w-80 flex flex-col rounded-md border border-solid overflow-hidden bg-[var(--eem-bg-primary)] border-[var(--eem-border-primary)] min-h-0",children:e.jsx("div",{className:"flex-shrink-0 px-4 py-3 border-b border-solid border-[var(--eem-border-primary)] bg-[var(--sidebar-bg-primary)]",children:e.jsx("h3",{className:"font-semibold text-sm",children:"Carregando contatos..."})})}):e.jsxs("div",{className:"w-80 flex flex-col rounded-md border border-solid overflow-hidden bg-[var(--eem-bg-primary)] border-[var(--eem-border-primary)] min-h-0",children:[e.jsx("div",{className:"flex-shrink-0 px-4 py-3 border-b border-solid border-[var(--eem-border-primary)] bg-[var(--sidebar-bg-primary)]",children:e.jsxs("h3",{className:"font-semibold text-sm flex items-center gap-2",children:[e.jsx("span",{children:"Contatos"}),e.jsx("span",{className:"badge badge-neutral badge-xs",children:x.length})]})}),e.jsx("div",{ref:o,className:"flex-1 overflow-y-auto p-2 min-h-0",children:e.jsx("div",{style:{height:`${m.getTotalSize()}px`,width:"100%",position:"relative"},children:m.getVirtualItems().map(l=>{const p=x[l.index],g=l.index<a.currentContactIndex,u=l.index===a.currentContactIndex&&n;return e.jsxs("div",{"data-index":l.index,ref:m.measureElement,className:`flex items-center gap-2.5 px-3 py-2 rounded-md transition-all mb-1.5 ${u?"bg-primary/10 ring-1 ring-primary":g?"bg-success/10":"opacity-50 bg-[var(--sidebar-bg-primary)]"}`,style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${l.start}px)`},children:[e.jsx(xe,{contact:p,size:d==="2xl"?"sm":"xs"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-xs 2xl:text-sm truncate",children:p.name}),e.jsx("div",{className:"text-xs opacity-70 truncate",children:p.phone})]}),e.jsxs("div",{className:"flex-shrink-0",children:[g&&e.jsx(je,{className:"text-success",size:18}),u&&e.jsx("span",{className:"loading loading-spinner loading-xs text-primary"})]})]},l.key)})})})]})},cn=()=>{const t=h(y=>y.currentCampaignId),{execution:s,isRunning:a,isPaused:n,isCompleted:r,isCancelled:i,campaign:o}=ee(t);if(!o)return e.jsx("div",{className:"text-center py-8",children:"Nenhuma campanha selecionada"});const d=s&&s.currentContactIndex<o.selectedContacts.length?o.selectedContacts[s.currentContactIndex]:null,x=(s==null?void 0:s.currentActionIndex)??0,m=o.actions[x],l=m?Ve(m.type):null,p=n&&(s==null?void 0:s.isAutoPause)===!0,g={idle:{title:"Pronto para enviar",subtitle:"Inicie o envio ou faça um teste"},running:{title:"Enviando mensagens...",subtitle:d?`Enviando para ${d.name}`:"Processando..."},paused:{title:"Campanha pausada",subtitle:"Continue de onde parou"},completed:{title:"Envio concluído!",subtitle:"Todas as mensagens foram processadas"},cancelled:{title:"Envio cancelado",subtitle:"O envio foi interrompido"}},u=s?a?"running":n?"paused":r?"completed":"cancelled":"idle",{title:c,subtitle:b}=g[u];return e.jsxs(e.Fragment,{children:[e.jsx(_e,{title:c,subtitle:b}),e.jsxs("div",{className:"flex flex-col gap-2 border border-solid border-[var(--sidebar-line-color)] rounded-md p-2 2xl:p-4",children:[e.jsxs("div",{className:"h-[64vh] flex gap-2",children:[e.jsx(on,{}),s&&o.selectedContacts.length>0&&e.jsx(ln,{})]}),!s&&e.jsxs("div",{className:"alert alert-info py-1.5 2xl:py-2.5 text-xs 2xl:text-sm !rounded-md",children:[e.jsx(je,{size:18}),e.jsxs("span",{children:[e.jsx("strong",{children:"Dicas:"})," Faça um teste antes • Pause quando quiser"]})]}),p&&e.jsxs("div",{className:"alert alert-warning py-1.5 2xl:py-2.5 text-xs 2xl:text-sm !rounded-md",children:[e.jsx(gt,{size:18,className:"animate-pulse"}),e.jsx("div",{className:"flex flex-col",children:e.jsxs("span",{children:[e.jsx(ve,{size:14,className:"inline mb-0.5"})," ",e.jsx("strong",{children:"Pausa Automática"})," • Processados ",e.jsx("strong",{children:s==null?void 0:s.currentContactIndex})," de ",e.jsx("strong",{children:s==null?void 0:s.totalContacts})," contatos"]})})]}),n&&!p&&e.jsxs("div",{className:"alert alert-warning py-1.5 2xl:py-2.5 text-xs 2xl:text-sm !rounded-md",children:[e.jsx(ve,{size:18}),e.jsxs("span",{children:[e.jsx(ve,{size:14,className:"inline mb-0.5"})," ",e.jsx("strong",{children:"Pausado Manualmente"})," • Contato ",e.jsx("strong",{children:(s==null?void 0:s.currentContactIndex)+1})," de ",e.jsx("strong",{children:s==null?void 0:s.totalContacts}),l&&` • Ação: ${l.title} (${(s==null?void 0:s.currentActionIndex)+1}/${o.actions.length})`]})]}),r&&e.jsxs("div",{className:"alert alert-success py-1.5 2xl:py-2.5 text-xs 2xl:text-sm !rounded-md",children:[e.jsx(je,{size:18}),e.jsx("span",{children:e.jsx("strong",{children:"Envio Concluído!"})})]}),i&&e.jsxs("div",{className:"alert alert-error py-1.5 2xl:py-2.5 text-xs 2xl:text-sm !rounded-md",children:[e.jsx(pt,{size:18}),e.jsx("span",{children:e.jsx("strong",{children:"Envio Cancelado"})})]})]})]})},dn=({action:t,index:s})=>{const a=Ve(t.type),n=a.icon;return e.jsxs("div",{className:"flex bg-[var(--contact-card-bg)] rounded-md items-center gap-2 2xl:gap-3 p-1.5 2xl:p-3 border-[var(--sidebar-line-color)] border border-solid",children:[e.jsx("div",{className:"size-5 2xl:size-6 bg-[var(--terciaria)] rounded-full flex items-center justify-center text-[var(--primaria)] font-semibold text-xs",children:s+1}),a.icon&&e.jsx("div",{className:"size-6 2xl:size-8 flex items-center justify-center",children:e.jsx(n,{size:16})}),e.jsxs("div",{className:"flex-1",children:[a.title&&e.jsx("div",{className:"font-semibold text-xs 2xl:text-sm",children:a.title}),a.description&&e.jsx("div",{className:"text-xs",children:a.description})]})]})},kt=({onClick:t})=>{const s=h(r=>r.campaigns.find(i=>i.id===r.currentCampaignId)),a=s.status===_.SENDING||s.status===_.PAUSED,n=()=>{a||t()};return e.jsxs("button",{onClick:n,disabled:a,className:`ml-auto text-blue-600 hover:text-blue-700 active:scale-[0.98] hover:scale-[1.02] text-xs 2xl:text-sm font-medium
     flex items-center gap-1 disabled:opacity-50 disabled:cursor-not-allowed transition-all`,children:[e.jsx(Ss,{className:"text-base 2xl:text-2xl"}),"Editar"]})},mn=()=>{const t=h(i=>i.campaigns.find(o=>o.id===i.currentCampaignId)),{setCurrentStep:s}=z.getState(),{ref:a,onMouseDown:n}=Ct(),{actions:r}=t;return e.jsxs("div",{className:"h-full flex-1 flex flex-col p-3 2xl:p-4 border border-[var(--sidebar-line-color)] border-solid rounded-md",children:[e.jsxs("div",{className:"flex items-center gap-1 2xl:gap-2 mb-2 2xl:mb-4",children:[e.jsx(ct,{className:"text-base 2xl:text-2xl"}),e.jsx("h2",{className:"text-sm 2xl:text-base font-medium",children:"Sequência de Ações"}),e.jsx(kt,{onClick:()=>s("acoes")})]}),e.jsx("div",{ref:a,className:"flex flex-col gap-1 2xl:gap-2 mb-2 2xl:mb-4 pb-0.5 2xl:pb-1 pr-1 overflow-y-auto flex-1 min-h-0 select-none",onMouseDown:n,style:{WebkitOverflowScrolling:"touch"},children:r.map((i,o)=>e.jsx("div",{children:e.jsx(dn,{action:i,index:o},i.id)}))}),e.jsxs("div",{className:"mt-auto border-t border-solid border-[var(--sidebar-line-color)] pt-1.5 2xl:pt-3 space-y-0.5 2xl:space-y-1 w-full",children:[e.jsx(Y,{label:"Total de ações:",value:r.length}),e.jsx(Y,{label:"Tempo estimado:",value:"~5 minutos"})]})]})},xn=50,un=()=>{const t=h(g=>g.campaigns.find(u=>u.id===g.currentCampaignId)),s=P(g=>g.contacts),{setCurrentStep:a}=z.getState(),{ref:n,onMouseDown:r}=Ct(),{selectedContacts:i}=t,o=i.slice(0,xn),d=Math.max(0,i.length-o.length),{breakpoint:x}=G(),m=x==="2xl"?"sm":"xs",p=!bt(g=>g.user.estado);return e.jsxs("div",{className:"h-full flex flex-col p-3 2xl:p-4 border border-[var(--sidebar-line-color)] border-solid rounded-md",children:[e.jsxs("div",{className:"flex items-center gap-1 2xl:gap-2 mb-2 2xl:mb-4",children:[e.jsx(xt,{className:"text-base 2xl:text-2xl"}),e.jsx("h2",{className:"text-sm 2xl:text-base font-medium",children:"Destinatários"}),e.jsx(kt,{onClick:()=>a("contatos")})]}),e.jsxs("div",{className:"mb-2 2xl:mb-4",children:[e.jsxs("div",{className:"text-xs 2xl:text-sm font-medium",children:[i.length," contatos selecionados"]}),e.jsxs("div",{className:"text-xs",children:["De um total de ",s.length," contatos"]})]}),e.jsxs("div",{ref:n,className:`grid 2xl:grid-cols-4 xl:grid-cols-3 lg:grid-cols-2 grid-cols-1 auto-rows-[2rem] 2xl:auto-rows-[2.8rem] 
        gap-1 2xl:gap-2 mb-2 2xl:mb-4 pb-0.5 2xl:pb-1 pr-1 overflow-y-auto flex-1 min-h-0 select-none`,onMouseDown:r,style:{WebkitOverflowScrolling:"touch"},children:[o.map((g,u)=>e.jsxs("div",{className:v("flex items-center justify-start gap-1 2xl:gap-2 h-full flex-none p-0.5 2xl:p-1","bg-[var(--contact-card-bg)] border border-[var(--sidebar-line-color)] border-solid rounded-md",p&&u>=5&&"opacity-40"),title:g.name,children:[e.jsx(xe,{contact:g,size:m}),e.jsx("span",{className:"text-xs 2xl:text-sm font-semibold truncate flex-1",children:g.name})]},g.id)),d>0&&e.jsx("div",{className:`flex items-center justify-center gap-1 2xl:gap-2 h-full flex-none 
            p-1.5 2xl:p-2 border border-[var(--sidebar-line-color)] border-dashed rounded-md`,children:e.jsxs("span",{className:"text-xs 2xl:text-sm text-center font-semibold truncate flex-1",children:["+",d]})},"extra-count")]})]})},pn=()=>{const t=h(a=>a.campaigns.find(n=>n.id===a.currentCampaignId)),{actions:s}=ee(t.id);return e.jsxs("div",{className:"col-span-1 flex flex-col p-3 2xl:p-4 bg-amber-100 border border-yellow-300 border-solid rounded-md",children:[e.jsxs("div",{className:"flex gap-1 2xl:gap-2 items-center",children:[e.jsx(Le,{className:"text-yellow-600 text-base 2xl:text-2xl"}),e.jsx("h2",{className:"text-sm 2xl:text-base font-medium text-yellow-600",children:"Importante"})]}),e.jsx("p",{className:"text-xs 2xl:text-sm text-yellow-600 font-medium",children:"As ações serão executadas na ordem definida para cada contato. Antes de iniciar o envio, certifique-se de que a sequência está correta e configurada conforme desejado. Recomendamos executar um teste primeiro."}),e.jsx("button",{className:`w-fit bg-white text-black text-xs 2xl:text-sm p-1 2xl:p-1.5 border border-solid border-gray-200
        rounded mt-1.5 2xl:mt-2 hover:bg-gray-100 hover:scale-[1.02] active:scale-[0.98] transition-all`,onClick:s.sendTest,children:"Executar teste para mim"})]})},gn=()=>{const t=bt(n=>n.user.estado),s=Ts(n=>n.label.checkout),a=!t;return e.jsxs("div",{className:"col-span-1 flex flex-col p-3 2xl:p-4 bg-blue-100 border border-blue-300 border-solid rounded-md",children:[e.jsxs("div",{className:"flex gap-1 2xl:gap-2 items-center",children:[e.jsx(Le,{className:"text-blue-600 text-base 2xl:text-2xl"}),e.jsx("h2",{className:"text-sm 2xl:text-base font-medium text-blue-600",children:a?"Versão Gratuita":"Versão Premium"})]}),a?e.jsx("p",{className:"text-xs 2xl:text-sm text-blue-600 font-medium",children:"Você está na versão gratuita. Apenas os 5 primeiros contatos serão processados. Para enviar a todos os contatos, atualize para a versão Premium."}):e.jsx("p",{className:"text-xs 2xl:text-sm text-blue-600 font-medium",children:"Você está utilizando a versão Premium. Todos os contatos da sua lista serão processados sem limitações. Aproveite o envio completo e ilimitado para sua campanha."}),a&&e.jsx("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:`w-fit bg-white text-black text-xs 2xl:text-sm p-1 2xl:p-1.5 border border-solid border-gray-200
          rounded mt-1.5 2xl:mt-2 hover:bg-gray-100 hover:scale-[1.02] active:scale-[0.98] transition-all`,children:"Atualizar para Premium"})]})},bn=()=>{const s=h(r=>r.campaigns.find(i=>i.id===r.currentCampaignId)).status,a=s===_.SENDING||s===_.PAUSED,n=v("grid-rows-[clamp(360px,40dvh,497px)] auto-rows-[clamp(360px,40dvh,497px)]","lg:grid-rows-[clamp(250px,40dvh,497px)] lg:auto-rows-[clamp(250px,40dvh,497px)]","xl:grid-rows-[clamp(360px,44dvh,497px)] xl:auto-rows-[clamp(360px,44dvh,497px)]","2xl:grid-rows-[clamp(360px,45dvh,497px)] 2xl:auto-rows-[clamp(360px,45dvh,497px)]");return e.jsxs(e.Fragment,{children:[e.jsx(_e,{title:a?"Enviando Ações":"Revise e confirme",subtitle:a?"As ações estão sendo executadas. Por favor, aguarde...":"Verifique os detalhes antes de executar as ações"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-2 2xl:gap-4",children:[e.jsxs("div",{className:v("col-span-full grid grid-cols-1 lg:grid-cols-2 gap-2 2xl:gap-4",n),children:[e.jsx(mn,{}),e.jsx(un,{})]}),e.jsxs("div",{className:v("col-span-full grid grid-cols-1 lg:grid-cols-2 gap-2 2xl:gap-4"),children:[e.jsx(pn,{}),e.jsx(gn,{})]})]})]})},fn=()=>{const t=z(n=>n.currentStep),s={contatos:an,acoes:ba,revisao:bn,envio:cn,resultados:rn},a=()=>{const n=s[t];return e.jsx(n,{})};return e.jsx("div",{className:"flex-1",children:a()})},nt=({onClick:t,disabled:s,children:a,variant:n="primary",className:r})=>e.jsx("button",{onClick:t,disabled:s,className:v("p-1.5 2xl:p-2.5 rounded-md transition-colors disabled:opacity-70 disabled:cursor-not-allowed","flex items-center justify-center gap-1 2xl:gap-1.5 text-xs 2xl:text-base font-semibold",n==="primary"?"bg-black text-white dark:bg-white dark:text-black":"border border-solid",r),children:a}),hn={contatos:t=>{var s;return(((s=t.selectedContacts)==null?void 0:s.length)||0)===0?{isValid:!1,message:w.getState().language.validate_selecione_destinatario}:{isValid:!0}},acoes:t=>{var s;return(((s=t.actions)==null?void 0:s.length)||0)===0?{isValid:!1,message:w.getState().language.validate_adicione_acao}:{isValid:!0}},revisao:()=>({isValid:!0}),envio:()=>({isValid:!0}),resultados:()=>({isValid:!0})};function vn(){const{campaigns:t,currentCampaignId:s}=h.getState(),a=t.find(r=>r.id===s);if(!a)return{isValid:!1,message:w.getState().language.validate_nenhuma_campanha};const n=z.getState().currentStep;return hn[n](a)}const jn=()=>{const{close:t}=D.getState(),{close:s}=ze.getState(),{setCurrentStep:a}=z.getState(),n=()=>{a("envio"),t()},r=()=>{t(),s()};return e.jsxs("div",{className:"flex flex-col gap-y-6 max-w-lg",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-[var(--primary-strong)] mb-2",children:"Envio iniciado com sucesso!"}),e.jsx("p",{className:"text-[var(--light-text-color)] text-sm leading-relaxed",children:"Envio iniciado com sucesso. O processo seguirá em segundo plano e não será interrompido ao alternar para o WhatsApp. Clique em Acompanhar envio para monitorar o progresso."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row-reverse gap-3 pt-2",children:[e.jsx("button",{onClick:n,className:v("flex-1 flex items-center justify-center gap-x-2 px-6 py-3 rounded-lg","font-medium transition-all duration-200","bg-gray-100 text-gray-900 hover:bg-gray-200","focus:outline-none focus:ring-1 focus:ring-offset-1 focus:ring-gray-400"),children:"Acompanhar envio"}),e.jsxs("button",{onClick:r,className:v("flex-1 flex items-center justify-center gap-x-2.5 px-6 py-3 rounded-lg","font-medium transition-all duration-200","bg-[#25D366] text-white hover:bg-[#128C7E]","focus:outline-none focus:ring-1 focus:ring-offset-1 focus:ring-[#25D366]"),children:[e.jsx(ot,{className:"w-5 h-5"}),"Voltar ao WhatsApp"]})]})]})},yn=()=>{const t=h(l=>l.campaigns.find(p=>p.id===l.currentCampaignId));if(!t)return null;const[s,a]=N.useState(!1),[n,r]=N.useState(!1),{close:i}=D.getState(),{actions:o}=ee(t.id),d=async()=>{if(!s){r(!0);return}i(),o.sendFull(),D.getState().open(e.jsx(jn,{}),!1,void 0,!0)},x=()=>{i()},m=()=>{a(!s),n&&r(!1)};return e.jsxs("div",{className:"flex max-w-lg flex-col gap-y-5 font-sans",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-2xl font-medium text-[var(--primary-strong)]",children:"Termos de uso"}),e.jsx("button",{onClick:x,className:"text-2xl text-gray-500 hover:text-gray-800 transition-colors","aria-label":"Fechar modal",children:"×"})]}),e.jsxs("div",{className:"border-t border-solid border-[#E4E4E4] pt-4",children:[e.jsx("h3",{className:"font-semibold mb-2 text-[var(--primary-strong)]",children:"Termos de uso"}),e.jsx("p",{className:"text-[var(--light-text-color)] leading-relaxed",children:"A prática de envios em massa ou spam podem ocasionar o banimento do seu número por parte do WhatsApp. Envie mensagens apenas para pessoas que gostariam de receber sua mensagem."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-x-2 cursor-pointer text-gray-700",children:[e.jsx("input",{type:"checkbox",checked:s,onChange:m,className:"checkbox checkbox-sm checkbox-success","aria-describedby":"error-message"}),e.jsx("span",{className:"text-[var(--primary-strong)] font-semibold",children:"Eu entendo e aceito os termos de uso"})]}),n&&e.jsx("p",{id:"error-message",className:"text-red-600 text-sm mt-2",role:"alert",children:"Você precisa aceitar os termos para continuar."})]}),e.jsxs("div",{className:"flex justify-end items-center gap-x-3 border-t border-[#E4E4E4] pt-4",children:[e.jsx("button",{onClick:x,className:`px-6 py-3 rounded-md bg-[#1d1d1d] text-white font-semibold
          transition-colors duration-150 hover:bg-[#141414]
          focus:outline-none focus:ring-2 focus:ring-gray-500`,children:"Cancelar"}),e.jsx("button",{onClick:d,disabled:!s,className:v("px-8 py-3 rounded-md font-semibold transition-colors duration-150","focus:outline-none focus:ring-2 focus:ring-offset-2",s?"bg-[var(--primaria)] text-white hover:bg-[color-mix(in_srgb,var(--primaria)_85%,black_15%)] focus:ring-[var(--primaria)]":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:"Enviar"})]})]})},Nn=()=>{const t=w(m=>m.language),s=h(m=>m.campaigns.find(l=>l.id===m.currentCampaignId));if(!s)return{config:{},getConfig:()=>{}};const a=s.status,n=()=>a===_.DRAFT?t.step_config_executar_acoes:a===_.SENDING?t.step_config_enviando:t.step_config_executar_acoes,{setCurrentStep:r}=z.getState(),{clearExecution:i}=ft.getState(),o=()=>()=>{s&&(i(s.id),r("acoes"))},d={contatos:{nextLabel:t.step_config_proximo,nextIcon:e.jsx(Fe,{size:18}),previousLabel:t.step_config_voltar,previousIcon:e.jsx(be,{size:18})},acoes:{nextLabel:t.step_config_proximo,nextIcon:e.jsx(Fe,{size:18}),previousLabel:t.step_config_voltar,previousIcon:e.jsx(be,{size:18})},revisao:{nextLabel:n(),nextIcon:e.jsx(ks,{size:18}),previousLabel:t.step_config_voltar,previousIcon:e.jsx(be,{size:18}),nextPersonalizedAction:()=>D.getState().open(e.jsx(yn,{}),!1,void 0,!0)},envio:{nextLabel:t.step_config_ver_resultados,previousLabel:t.step_config_voltar,previousIcon:e.jsx(be,{size:18}),nextIcon:e.jsx(Fe,{size:18})},resultados:{nextLabel:t.step_config_nova_sequencia,previousLabel:t.step_config_retornar_gerenciador,prevPersonalizedAction:()=>te.getState().setActivePage("campaigns"),nextPersonalizedAction:o()}};return{config:d,getConfig:m=>d[m]}},Cn=()=>{const s=h(b=>b.campaigns.find(y=>y.id===b.currentCampaignId)).status,{currentStep:a,steps:n,setCurrentStep:r}=z(Ys(b=>({currentStep:b.currentStep,steps:b.steps,setCurrentStep:b.setCurrentStep}))),i=n.findIndex(b=>b.key===a),o=i===0,d=i===n.length-1,x=s===_.SENDING||s===_.PAUSED,{getConfig:m}=Nn(),l=m(a),p=x?!0:o&&!l.prevPersonalizedAction,g=x?!0:d&&!l.nextPersonalizedAction,u=b=>{if(b==="next"&&l.nextPersonalizedAction){l.nextPersonalizedAction();return}if(b==="previous"&&l.prevPersonalizedAction){l.prevPersonalizedAction();return}c(b)},c=b=>{if(b==="next"&&!d){const y=vn();if(!y.isValid){I({type:"Error",message:y.message||"Erro ao validar etapa."});return}r(n[i+1].key)}else b==="previous"&&!o&&r(n[i-1].key)};return e.jsxs("div",{className:"flex justify-between my-4 2xl:my-6 2xl:gap-2 gap-1",children:[e.jsxs(nt,{className:v(a==="resultados"&&"w-full"),onClick:()=>u("previous"),disabled:p,variant:"secondary",children:[l.previousIcon,l.previousLabel]}),e.jsxs(nt,{className:v(a==="resultados"&&"w-full"),onClick:()=>u("next"),disabled:g,variant:"primary",children:[l.nextLabel,l.nextIcon]})]})},wn=()=>{const t=w(i=>i.language),s=ta(),a=z(i=>i.currentStep),{setActivePage:n}=te.getState(),r=ye(i=>i.isHidden);return s?e.jsxs(e.Fragment,{children:[e.jsx(ra,{}),e.jsxs("div",{className:v("flex flex-col",a==="resultados"?"2xl:px-80 px-60":"2xl:px-36 px-24 justify-between flex-1",r?"pt-6":"pt-0"),children:[e.jsx(fn,{}),e.jsx(Cn,{})]})]}):e.jsx("div",{className:"flex-1 flex flex-col items-center justify-center bg-[var(--eem-bg-primary)]",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-center gap-1",children:[e.jsx("div",{className:"p-2 rounded-md border border-solid border-[var(--eem-border-primary)]",children:e.jsx(As,{className:"size-7"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl leading-snug font-semibold",children:t.messaging_nenhuma_campanha}),e.jsx("p",{className:"text-base",children:t.messaging_selecione_ou_crie})]}),e.jsx("button",{className:`py-1 px-2 bg-[var(--primaria)] font-semibold rounded-md text-base text-white 
            hover:brightness-95 hover:scale-105 active:scale-95 transition`,onClick:()=>n("campaigns"),children:t.messaging_ir_gerenciador})]})})};function rt(t){const s=w.getState().language;h.getState().setCurrentCampaignId(t);const a=h.getState().campaigns.find(r=>r.id===t);if(!a){I({type:"Error",message:s.campanha_nao_encontrada});return}const n=a.status===_.SENDING||a.status===_.PAUSED;z.getState().setCurrentStep(n?"envio":"contatos"),te.getState().setActivePage("sendFastCampaign")}const _n=({campaign:t})=>{const s=w(i=>i.language),a=h.getState().removeCampaign;function n(i){return{[_.SENDING]:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400",[_.SENT]:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",[_.FAILED]:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400",[_.DRAFT]:"bg-gray-100 text-gray-800 dark:bg-gray-700/30 dark:text-gray-300",[_.PAUSED]:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900/20 dark:text-indigo-400"}[i]??"bg-gray-100 text-gray-800 dark:bg-gray-700/50 dark:text-gray-300"}const r=i=>{i.stopPropagation(),Ps({icon:e.jsx(Ze,{size:20,className:"text-red-600 dark:text-red-400"}),content:s.card_confirmar_excluir,confirmText:s.card_excluir,submit:()=>a(t.id)})};return e.jsxs("div",{role:"button",className:`rounded-xl p-4 flex flex-col justify-between cursor-pointer shadow-sm hover:shadow-md bg-[var(--contact-card-bg)] 
      border border-solid border-[var(--eem-border-primary)] hover:border-[var(--primaria)] transition-transform transform-gpu hover:-translate-y-0.5`,onClick:()=>rt(t.id),title:s.card_clique_abrir,children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h3",{className:"font-semibold text-sm line-clamp-2",children:t.name}),e.jsx("div",{className:`badge text-[13px] ${n(t.status)}`,children:String(t.status)})]}),e.jsxs("p",{className:"text-xs text-[var(--light-text-color)]",children:[s.card_criada," ",t.createdAt.toLocaleString(void 0,{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})]}),e.jsxs("p",{className:"text-xs text-[var(--light-text-color)]",children:[s.card_atualizada," ",t.updatedAt.toLocaleString(void 0,{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})]}),e.jsxs("div",{className:"mt-3 flex items-center gap-4 text-sm text-[var(--light-text-color)]",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Hs,{size:14}),e.jsx("span",{className:"text-sm",children:t.selectedContacts.length})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ks,{size:14}),e.jsx("span",{className:"text-sm",children:t.actions.length})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between gap-2 mt-4",children:[e.jsxs("button",{onClick:i=>{i.stopPropagation(),rt(t.id)},title:s.card_abrir_campanha,className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium rounded-md border border-solid border-[var(--light-text-color)]/20 hover:bg-[var(--light-text-color)]/10 transition-all transform-gpu hover:-translate-y-0.5",children:[e.jsx(Xs,{size:14}),e.jsx("span",{className:"hidden sm:inline",children:s.card_abrir})]}),e.jsx("button",{onClick:r,className:"flex items-center gap-2 p-2 text-base font-medium text-red-600 dark:text-red-400 border border-red-600/20 dark:border-red-400/20 rounded-md hover:bg-red-50 dark:hover:bg-red-900/10 transition-all transform-gpu hover:-translate-y-0.5",title:s.card_deletar_campanha,children:e.jsx(Ze,{size:16})})]})]})},Sn=()=>{const t=w(m=>m.language),[s,a]=K.useState(!1),n=h(m=>m.addCampaign),r=K.useRef(null),i=m=>{m.preventDefault();const p=new FormData(m.currentTarget).get("campaignName");if(!(p!=null&&p.trim())){I({type:"Error",message:t.create_campaign_nome_vazio});return}const{newCampaign:g}=Nt({name:p.trim()});n(g),I({type:"Success",message:t.create_campaign_criada_sucesso}),r.current&&r.current.reset(),a(!1)},o=()=>{a(!1),r.current&&r.current.reset()},d=()=>v("btn btn-sm rounded-md bg-[var(--primaria)] text-white hover:bg-[var(--primaria)]/90","transition-all duration-150 hover:scale-[1.02] active:scale-95 active:opacity-80"),x=()=>v("h-8 px-2 rounded-md bg-[var(--primaria)] text-white hover:bg-[var(--primaria)]/90","transition-all duration-150 hover:scale-[1.02] active:scale-95 active:opacity-80","flex items-center justify-center");return e.jsx(e.Fragment,{children:s?e.jsxs("form",{className:"flex items-center gap-2",onSubmit:i,ref:r,children:[e.jsx("input",{type:"text",name:"campaignName",className:`px-3 h-8 rounded-md border border-solid border-[var(--eem-border-primary)]
            text-sm placeholder:text-sm focus:outline-none focus:ring-2 focus:ring-[var(--primaria)]/50`,placeholder:t.create_campaign_nome_placeholder,autoFocus:!0}),e.jsx("button",{type:"submit",title:t.create_campaign_criar_titulo,className:x(),children:e.jsx(jt,{size:16,className:"text-white"})}),e.jsx("button",{type:"button",title:t.create_campaign_cancelar_titulo,onClick:o,className:v(x(),"bg-gray-500 hover:bg-gray-600"),children:e.jsx(yt,{size:16,className:"text-white"})})]}):e.jsx("button",{type:"button",className:d(),onClick:()=>a(!0),children:t.create_campaign_nova_campanha})})},kn=()=>{const t=w(a=>a.language),s=h(a=>a.campaigns).slice().sort((a,n)=>(n.updatedAt??n.createdAt).getTime()-(a.updatedAt??a.createdAt).getTime());return e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between flex-shrink-0 border-b border-solid border-[var(--eem-border-primary)] p-6",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("h2",{className:"text-lg 2xl:text-xl font-bold leading-none",children:t.campaign_feature_titulo}),e.jsx("div",{className:"badge badge-xs 2xl:badge-sm bg-[var(--primaria)] text-white",children:s.length})]}),e.jsx(Sn,{})]}),e.jsx("div",{className:"flex-1 min-h-0 p-6",children:s.length===0?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("p",{className:"2xl:text-base text-sm text-gray-500",children:t.campaign_feature_nenhuma})}):e.jsx("div",{className:"h-full overflow-y-auto p-1",children:e.jsx("div",{className:"grid grid-cols-2 gap-2",children:s.map(a=>e.jsx(_n,{campaign:a},a.id))})})})]})},An=()=>e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Análises"}),e.jsx("p",{className:"text-lg text-gray-700",children:"Visualize as análises de suas campanhas e envios em massa aqui."})]}),Pn=()=>{const t=te(n=>n.activePage),s=w(n=>n.language),a=()=>{switch(t){case"sendFastCampaign":return e.jsx(wn,{});case"campaigns":return e.jsx(kn,{});case"analytics":return e.jsx(An,{});default:return e.jsx("div",{className:"px-36 pt-12",children:s.selecione_pagina_valida})}};return e.jsx("main",{className:"flex-1 flex flex-col overflow-auto",children:a()})};function Fn(){const{crm:t}=Re.getState(),{activeCrm:s}=Q.getState(),{activeCrmTab:a}=ce.getState();if(s==="all"){const i=t.flatMap(o=>o.list??[]);return a==="all"?i.flatMap(o=>o.chats??[]):i.filter(o=>o.id===a).flatMap(o=>o.chats??[])}const n=t.find(i=>i.id===s),r=(n==null?void 0:n.list)??[];return a==="all"?r.flatMap(i=>i.chats??[]):r.filter(i=>i.id===a).flatMap(i=>i.chats??[])}function Tn(){const{userTabs:t}=$e.getState(),{activeUserTab:s}=de.getState();if(s==="all")return t.flatMap(n=>n.chats??[]);const a=t.find(n=>n.id===s);return(a==null?void 0:a.chats)??[]}async function In(t){const s=t.filter(a=>a!=null&&a.id!=null&&typeof a.id=="string"&&a.id.trim()!=="");return Promise.all(s.map(async a=>{const n=await va(a);return{id:a.id,name:n,...a}}))}async function En(){const{activeSwitch:t}=Z.getState(),s=t==="crm"?Fn():Tn(),a=await In(s);return Array.from(new Map(a.map(r=>[r.id,r])).values())}let ne=null;const zn=300*1e3;async function Dn(){const t=Date.now(),{activeGroup:s}=Ce.getState(),a=String(s);if(ne&&ne.group===a&&t-ne.timestamp<zn)return ne.data;let n=[];if(s==="all"){const r=await S.Group("getAllGroups");for(const i of r){const o=await S.Chat("List",{type:"getContatosGrupos",activeLid:!0,id:i.id});o&&o.length>0&&(n=[...n,...o])}n=Array.from(new Map(n.map(i=>[i.id,i])).values())}else{const r=await S.Chat("List",{type:"getContatosGrupos",activeLid:!0,id:s});r&&r.length>0&&(n=r)}return ne={data:n,group:a,timestamp:t},n}let V=null;const Ln=300*1e3;async function Mn(){try{const t=Date.now();if(V&&t-V.timestamp<Ln)return V.data;const a=(await S.Group("getAllGroups")).filter(n=>{var r;return(n==null?void 0:n.id)&&((r=n==null?void 0:n.name)==null?void 0:r.trim())}).sort((n,r)=>n.name.toLowerCase().localeCompare(r.name.toLowerCase(),"pt"));return V={data:a,timestamp:t},a}catch(t){return console.error("Erro ao buscar grupos:",t),(V==null?void 0:V.data)||[]}}let q=null;const Rn=300*1e3;async function $n(){try{const t=Date.now();if(q&&t-q.timestamp<Rn)return q.data;const a=(await S.Chat("List")).filter(n=>n==null?void 0:n.id);return q={data:a,timestamp:t},a}catch(t){return console.error("Erro ao buscar contatos da caixa de entrada:",t),(q==null?void 0:q.data)||[]}}const re={},On=300*1e3;async function Gn(){var t;try{const s=Date.now(),{activeLabel:a}=le.getState(),n=String(a);if(re[n]&&s-re[n].timestamp<On)return re[n].data;let r=[];if(a==="all"){const i=await S.Labels("getAllLabels");for(const o of i){const d=await S.Contact("List",{type:"withLabels",id:o.id});d&&d.length>0&&(r=[...r,...d])}r=Array.from(new Map(r.map(o=>[o.id,o])).values())}else{const i=await S.Contact("List",{type:"withLabels",id:a});i&&i.length>0&&(r=i)}return re[n]={data:r,timestamp:s},r}catch(s){return console.error("Erro ao buscar contatos por label:",s),((t=re[String(le.getState().activeLabel)])==null?void 0:t.data)||[]}}let B=null;const Vn=300*1e3;async function qn(){try{const t=Date.now();if(B&&t-B.timestamp<Vn)return B.data;const a=(await S.Contact("List","onlyMyContacts")).map(r=>({...r,_sortKey:(r.name??"").toLowerCase()}));a.sort((r,i)=>r._sortKey.localeCompare(i._sortKey,"pt"));const n=a.map(({_sortKey:r,...i})=>i);return B={data:n,timestamp:t},n}catch(t){return console.error("Erro ao buscar contatos salvos:",t),(B==null?void 0:B.data)||[]}}async function Bn(){const t=Se.getState().importedContacts;return!t||t.length===0?[]:t}const T=t=>(t??"").toString().trim().toLowerCase(),it=t=>{const s=T(t);return s?["m","masc","masculino","male","h","homem"].includes(s)?"male":["f","fem","feminino","female","mulher"].includes(s)?"female":s==="male"||s==="female"?s:null:null},U=t=>{if(!t)return null;const s=t.toString().trim();if(!s)return null;const a=s.split(/[\/-]/).map(o=>o.trim());if(a.length<3)return null;if(a[0].length===4){const[o,d,x]=a.map(m=>Number(m));return!isFinite(o)||!isFinite(d)||!isFinite(x)?null:new Date(o,d-1,x)}const[n,r,i]=a.map(o=>Number(o));return!isFinite(i)||!isFinite(r)||!isFinite(n)?null:new Date(i,r-1,n)},Un=(t,s)=>{const a=U(t),n=U(s);return!a||!n?!1:a.getDate()===n.getDate()&&a.getMonth()===n.getMonth()};function Wn(){const t=$.getState().appliedFilters,s=J.getState().selectedOption,a=(t.interestedProducts||[]).map(g=>T(g)).filter(Boolean),n=T(t.city),r=T(t.state),i=T(t.company),o=T(t.jobTitle),d=T(t.leadSource),x=t.gender?it(t.gender):null,m=t.entryDate?U(t.entryDate):null,l=t.exitDate?U(t.exitDate):null,p=t.birthDate??null;return g=>{const u=it(g.sexo);if(s==="birthdaysThisMonth"){const c=U(g.dataNascimento),b=new Date().getMonth();if((c?c.getMonth():-1)!==b)return!1}else{if(s==="genderMale"&&u!=="male")return!1;if(s==="genderFemale"&&u!=="female")return!1}if(x&&u!==x||n&&!T(g.cidade).includes(n)||r&&T(g.estado)!==r||i&&!T(g.empresa).includes(i)||o&&!T(g.cargo).includes(o)||d&&T(g.origemLead)!==d)return!1;if(a.length>0){const c=(g.produtos||[]).map(y=>T(y));if(!a.some(y=>c.includes(y)))return!1}if(p&&g.dataNascimento&&!Un(g.dataNascimento,p))return!1;if(m&&g.entrada){const c=U(g.entrada);if(c&&c<m)return!1}if(l&&g.saida){const c=U(g.saida);if(c&&c>l)return!1}return!0}}async function Hn(){const t=Is.getState().perfil,s=Wn(),a=t.filter(s);return await Promise.all(a.map(async r=>{const i=we(r.userID),o=await S.Contact("get",i);return{id:o.id||r.userID,name:o.name||r.userID}}))}const Kn={savedContacts:qn,inbox:$n,labels:Gn,groups:Mn,groupContacts:Dn,crmOrTabs:En,contactProfile:Hn,importSpreadsheet:Bn},Xn=async()=>{const t=X.getState().activeFilter.id,s=Ne.getState().groupments.find(n=>n.id===t);return s?s.contacts||[]:[]};async function Yn(){const t=X.getState().activeFilter;if(t.type==="groupment")return Xn();const s=Kn[t.id];return s?await s():(console.warn(`Nenhuma função de busca definida para o filtro: ${t.id}`),[])}const Jn=1e3;async function Qn(t){const{setContacts:s,setLoading:a}=P.getState();if(t!=null&&t.aborted)throw new DOMException("Operation was aborted","AbortError");a(!0),s([]);try{const n=new Promise((d,x)=>{const m=setTimeout(d,Jn);t==null||t.addEventListener("abort",()=>{clearTimeout(m),x(new DOMException("Operation was aborted","AbortError"))})}),[r]=await Promise.all([Yn(),n]);if(t!=null&&t.aborted)throw new DOMException("Operation was aborted","AbortError");const i=await S.Conn("getMyUserId"),o=r.filter(d=>(d==null?void 0:d.id)!==void 0&&(d==null?void 0:d.id)!=null&&d.id.trim()&&!ha(d)&&d.id!=="0"&&d.id!=="status"&&d.id!==we(i)&&d.id!==i);if(!o.length){console.warn("Nenhum contato encontrado"),s([]);return}if(t!=null&&t.aborted)throw new DOMException("Operation was aborted","AbortError");s(o)}catch(n){n.name==="AbortError"?console.warn("Operação abortada pelo usuário"):console.error("Erro ao buscar contatos:",n),s([])}finally{a(!1)}}const Zn=t=>{const s=N.useRef(null);return N.useEffect(()=>{if(!t)return;const n=h.getState().campaigns.find(o=>o.id===t),r=(n==null?void 0:n.actions)??[];Te.getState().setAcao(r),s.current=r;const i=Te.subscribe(o=>{const d=o.acao??[];d!==s.current&&(s.current=d,h.getState().updateCampaign(t,{actions:d}))});return()=>{i()}},[t]),{clearAcaoOnly:()=>{Te.getState().clearAcao(),s.current=null}}};function er(){const t=h(u=>u.currentCampaignId),{getNewController:s}=Js(),{clearAcaoOnly:a}=Zn(t),n=X(u=>u.activeFilter),r=le(u=>u.activeLabel),i=Ce(u=>u.activeGroup),o=Z(u=>u.activeSwitch),d=Q(u=>u.activeCrm),x=de(u=>u.activeUserTab),m=ce(u=>u.activeCrmTab),l=$(u=>u.appliedFilters),p=J(u=>u.selectedOption),g=Se(u=>u.importedContacts);return N.useEffect(()=>{const u=s();return Qn(u),()=>a()},[n,r,i,l,o,d,x,m,p,g]),e.jsxs("div",{className:"w-screen h-screen overflow-hidden bg-[var(--eem-bg-primary)] flex text-[var(--primary-strong)]","data-id":"eem-new",children:[e.jsx(ea,{}),e.jsx(Pn,{})]})}function $r(){return na(h,1e3)?e.jsx(er,{}):e.jsx("div",{className:"w-screen h-screen flex items-center justify-center bg-[var(--eem-bg-primary)]",children:e.jsx(Qs,{size:60,className:"text-[var(--primaria)] animate-spin"})})}export{$r as default};
